<html><head></head><body>
		<div>
			<div id="_idContainer008" class="Content">
			</div>
		</div>
		<div id="_idContainer009" class="Content">
			<h1 id="_idParaDest-18">1. <a id="_idTextAnchor018"/>Introduction to Neural Networks and Deep Learning</h1>
		</div>
		<div id="_idContainer024" class="Content">
			<p class="callout-heading">Overview</p>
			<p class="callout">In this chapter, we will cover the basics of neural networks and how to set up a deep learning programming environment. We will also explore the common components and essential operations of a neural network . We will conclude this chapter with an exploration of a trained neural network created using TensorFlow. By the end of this chapter, you will be able to train a neural network.</p>
			<h1 id="_idParaDest-19"><a id="_idTextAnchor019"/>Introduction</h1>
			<p>This chapter is about understanding what neural networks can do rather than the finer workings of deep learning. For this reason, we will not cover the mathematical concepts underlying deep learning algorithms but will describe the essential pieces that make up a deep learning system and the role of neural networks within that system. We will also look at examples where neural networks have been used to solve real-world problems using these algorithms.</p>
			<p>At its core, this chapter challenges you to think about your problem as a mathematical representation of ideas. By the end of this chapter, you will be able to think about a problem as a collection of these representations and to recognize how these representations can be learned by deep learning algorithms.</p>
			<h1 id="_idParaDest-20"><a id="_idTextAnchor020"/>What are Neural Networks?</h1>
			<p>A <strong class="bold">neural network</strong> is a network of neurons. In our brain, we have a network of billions of neurons that are interconnected with each other. The neuron is one of the basic elements of the nervous system. The primary function of the neuron is to perform actions as a response to an event and transmit messages to other neurons. In this case, the action is simply either activating or deactivating itself. Taking inspiration from the brain's design, <strong class="bold">artificial neural networks</strong> were first proposed in the 1940s by MIT professors <em class="italic">Warren McCullough</em> and <em class="italic">Walter Pitts</em>.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information on neural networks, refer to <em class="italic">Explained: Neural networks. MIT News Office, April 14, 2017</em>, available at <a href="http://news.mit.edu/2017/explained-neural-networks-deep-learning-0414">http://news.mit.edu/2017/explained-neural-networks-deep-learning-0414</a>.</p>
			<p>Inspired by advancements in neuroscience, they proposed to create a computer system that reproduced how the brain works (human or otherwise). At its core was the idea of a computer system that worked as an interconnected network, that is, a system that has many simple components. These components interpret data and influence each other on how to interpret that data. The same core idea r emains today.</p>
			<p>Deep learning is largely considered the contemporary study of neural networks. Think of it as a contemporary name given to neural networks. The main difference is that the neural networks used in deep learning are typically far greater in size, meaning they have many more nodes and layers than earlier neural networks. Deep learning algorithms and applications typically require resources to achieve success, hence the use of the word <em class="italic">deep</em> to emphasize their size and the large number of interconnected components.</p>
			<h2 id="_idParaDest-21"><a id="_idTextAnchor021"/>Successful Applications of Neural Networks</h2>
			<p>Neural networks have been under research in one form or another since their inception in the 1940s. It is only recently that deep learning systems have been used successfully in large-scale industry applications.</p>
			<p>Contemporary proponents of neural networks have demonstrated great success in speech recognition, language translation, image classification, and other fields. Its current prominence is backed by a significant increase in available computing power and the emergence of <strong class="bold">Graphic Processing Units</strong> (<strong class="bold">GPUs</strong>) and <strong class="bold">Tensor Processing Units</strong> (<strong class="bold">TPUs</strong>), which can perform many more simultaneous mathematical operations than regular CPUs, as well as much greater availability of data. Compared to CPUs, GPUs are designed to execute special tasks (in the "single instruction, multiple threads" model) where the execution can be parallelized.</p>
			<p>One such success story is the power consumption of different AlphaGo algorithms. <strong class="bold">AlphaGo</strong> is an initiative by DeepMind to develop a series of algorithms to beat the game Go. It is considered a prime example of the power of deep learning. The team at DeepMind was able to do this using reinforcement learning in which AlphaGo becomes its own teacher.</p>
			<p>The neural network, which initially knows nothing, plays with itself to understand which moves lead to victory. The algorithm used TPUs for training. TPUs are a type of chipset developed by Google that are specialized for use in deep learning programs. The article <em class="italic">Alpha Zero: Starting from scratch</em>, <a href="https://deepmind.com/blog/alphago-zero-learning-scratch/">https://deepmind.com/blog/alphago-zero-learning-scratch/</a>, depicts the number of GPUs and TPUs used to train different versions of the AlphaGo algorithm.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">In this book, we will not be using GPUs to fulfill our activities. GPUs are not required to work with neural networks. In several simple examples—like the ones provided in this book—all computations can be performed using a simple laptop's CPU. However, when dealing with very large datasets, GPUs can be of great help given that the long time taken to train a neural network would otherwise be impractical.</p>
			<p>Here are a few examples where neural networks have had a significant impact:</p>
			<p><strong class="bold">Translating text</strong>: In 2017, Google announced the release of a new algorithm for its translation service called <strong class="bold">Transformer</strong>. The algorithm consisted of a recurrent neural network called <strong class="bold">Long Short-term Memory</strong> (<strong class="bold">LSTM</strong>) that was trained to use bilingual text. LSTM is a form of neural network that is applied to text data. Google showed that its algorithm had gained notable accuracy when compared to the industry standard, <strong class="bold">Bilingual Evaluation Understudy</strong> (<strong class="bold">BLEU</strong>), and was also computationally efficient. BLEU is an algorithm for evaluating the performance of machine-translated text. For more information on this, refer to the Google Research Blog, <em class="italic">Transformer: A Novel Neural Network Architecture for Language Understanding,</em> August 31, 2017, available at <a href="https://research.googleblog.com/2017/08/transformer-novel-neural-network.html">https://research.googleblog.com/2017/08/transformer-novel-neural-network.html</a>.</p>
			<p><strong class="bold">Self-driving vehicles</strong>: Uber, NVIDIA, and Waymo are believed to be using deep learning models to control different vehicle functions related to driving. Each company is researching several possibilities, including training the network using humans, simulating vehicles driving in virtual environments, and even creating a small city-like environment in which vehicles can be trained based on expected and unexpected events.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To know more about each of these achievements, refer to the following references.</p>
			<p class="callout"><strong class="bold">Uber:</strong> <em class="italic">Uber's new AI team is looking for the shortest route to self-driving cars</em>, <em class="italic">Dave Gershgorn</em>, <em class="italic">Quartz</em>, <em class="italic">December 5, 2016</em>, available at <a href="https://qz.com/853236/ubers-new-ai-team-is-looking-for-the-shortest-route-to-self-driving-cars/">https://qz.com/853236/ubers-new-ai-team-is-looking-for-the-shortest-route-to-self-driving-cars/</a>.</p>
			<p class="callout"><strong class="bold">NVIDIA</strong>: <em class="italic">End-to-End Deep Learning for Self-Driving Cars</em>, <em class="italic">August 17, 2016</em>, available at <a href="https://devblogs.nvidia.com/deep-learning-self-driving-cars/">https://devblogs.nvidia.com/deep-learning-self-driving-cars/</a>.</p>
			<p class="callout"><strong class="bold">Waymo</strong>: <em class="italic">Inside Waymo's Secret World for Training Self-Driving Cars. The Atlantic</em>, <em class="italic">Alexis C. Madrigal</em>, <em class="italic">August 23, 2017</em>, available at <a href="https://www.theatlantic.com/technology/archive/2017/08/inside-waymos-secret-testing-and-simulation-facilities/537648/">https://www.theatlantic.com/technology/archive/2017/08/inside-waymos-secret-testing-and-simulation-facilities/537648/</a>.</p>
			<p><strong class="bold">Image recognition</strong>: Facebook and Google use deep learning models to identify entities in images and automatically tag these entities as persons from a set of contacts. In both cases, the networks are trained with previously tagged images as well as with images from the target friend or contact. Both companies report that the models can suggest a friend or contact with a high level of accuracy in most cases.</p>
			<p>While there are many more examples in other industries, the application of deep learning models is still in its infancy. Many successful applications are yet to come, including the ones that you create.</p>
			<h1 id="_idParaDest-22"><a id="_idTextAnchor022"/>Why Do Neural Networks Work So Well?</h1>
			<p>Why are neural networks so powerful? Neural networks are powerful because they can be used to predict any given function with reasonable approximation. If we can represent a problem as a mathematical function and we have data that represents that function correctly, a deep learning model can, given enough resources, be able to approximate that function. This is typically called the <em class="italic">Universal Approximation Theorem</em>. For more information, refer to Michael Nielsen: <em class="italic">Neural Networks and Deep Learning: A visual proof that neural nets can compute any function</em>, available at <a href="http://neuralnetworksanddeeplearning.com/chap4.html">http://neuralnetworksanddeeplearning.com/chap4.html</a>.</p>
			<p>We will not be exploring mathematical proofs of the universality principle in this book. However, two characteristics of neural networks should give you the right intuition on how to understand that principle: representation learning and function approximation.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">For more information, refer to <em class="italic">A Brief Survey of Deep Reinforcement Learning</em>, <em class="italic">Kai Arulkumaran, Marc Peter Deisenroth, Miles Brundage, and Anil Anthony Bharath</em>, <em class="italic">arXiv</em>, <em class="italic">September 28, 2017</em>, available at <a href="https://www.arxiv-vanity.com/papers/1708.05866/">https://www.arxiv-vanity.com/papers/1708.05866/</a>.</p>
			<h2 id="_idParaDest-23"><a id="_idTextAnchor023"/>Representation Learning</h2>
			<p>The data used to train a neural network contains representations (also known as <em class="italic">features</em>) that explain the problem you are trying to solve. For instance, if we are interested in recognizing faces from images, the color values of each pixel from a set of images that contain faces will be used as a starting point. The model will then continuously learn higher-level representations by combining pixels together as it goes through its training process. A pictorial depiction is displayed here:</p>
			<div>
				<div id="_idContainer010" class="IMG---Figure">
					<img src="image/B15911_01_01.jpg" alt="Figure 1.1: A series of higher-level representations based on input data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.1: A series of higher-level representations based on input data</p>
			<p class="callout-heading">Note</p>
			<p class="callout"><em class="italic">Figure 1.1</em> is a derivate image based on an original image from Yann LeCun, Yoshua Bengio, and Geoffrey Hinton in <em class="italic">Deep Learning</em>, published in <em class="italic">Nature, 521, 436–444 (28 May 2015) doi:10.1038/ nature14539</em>. You can find the paper at: <a href="https://www.nature.com/articles/nature14539">https://www.nature.com/articles/nature14539</a>.</p>
			<p>In formal words, neural networks are computation graphs in which each step computes higher abstraction representations from input data. Each of these steps represents a progression into a different abstraction layer. Data progresses through each of these layers, thereby building higher-level representations. The process finishes with the highest representation possible: the one the model is trying to predict.</p>
			<h2 id="_idParaDest-24"><a id="_idTextAnchor024"/>Function Approximation</h2>
			<p>When neural networks learn new representations of data, they do so by combining weights and biases with neurons from different layers. They adjust the weights of these connections every time a training cycle occurs using a mathematical technique called <strong class="bold">backpropagation</strong>. The weights and biases improve at each round, up to the point that an optimum is achieved. This means that a neural network can measure how wrong it is on every training cycle, adjust the weights and biases of each neuron, and try again. If it determines that a certain modification produces better results than the previous round, it will invest in that modification until an optimal solution is achieved. </p>
			<p>So basically, in a single cycle, three things happen. The first one is forward propagation where we calculate the results using weights, biases, and inputs. In the second step, we calculate how far the calculated value is from the expected value using a loss function. The final step is to update the weights and biases moving in the reverse direction of forward propagation, which is called backpropagation. </p>
			<p>Since the weights and biases in the earlier layers do not have a direct connection with the later layers, we use a mathematical tool called the chain rule to calculate new weights for the earlier layers. Basically, the change in the earlier layer is equal to the multiplication of the gradients or derivatives of all the layers below it.</p>
			<p>In a nutshell, that procedure is the reason why neural networks can approximate functions. However, there are many reasons why a neural network may not be able to predict a function with perfection, chief among them being the following:</p>
			<ul>
				<li>Many functions contain stochastic properties (that is, random properties).</li>
				<li>There may be overfitting to peculiarities from the training data. Overfitting is a situation where the model we are training doesn't generalize well to data it has never seen before. It just learns the training data instead of finding some interesting patterns.</li>
				<li>There may be a lack of training data.</li>
			</ul>
			<p>In many practical applications, simple neural networks can approximate a function with reasonable precision. These sorts of applications will be our focus throughout this book.</p>
			<h2 id="_idParaDest-25"><a id="_idTextAnchor025"/>Limitations of Deep Learning</h2>
			<p>Deep learning techniques are best suited to problems that can be defined with formal mathematical rules (such as data representations). If a problem is hard to define this way, it is likely that deep learning will not provide a useful solution. Moreover, if the data available for a given problem is either biased or only contains partial representations of the underlying functions that generate that problem, deep learning techniques will only be able to reproduce the problem and not learn to solve it.</p>
			<p>Remember that deep learning algorithms learn different representations of data to approximate a given function. If data does not represent a function appropriately, it is likely that the function will be incorrectly represented by the neural network. Consider the following analogy: you are trying to predict the national prices of gasoline (that is, fuel) and create a deep learning model. You use your credit card statement with your daily expenses on gasoline as an input data for that model. The model may eventually learn the patterns of your gasoline consumption, but it will likely misrepresent price fluctuations of gasoline caused by other factors only represented weekly in your data such as government policies, market competition, international politics, and so on. The model will ultimately yield incorrect results when used in production. </p>
			<p>To avoid this problem, make sure that the data used to train a model represents the problem the model is trying to address as accurately as possible.</p>
			<h2 id="_idParaDest-26"><a id="_idTextAnchor026"/>Inherent Bias and Ethical Considerations</h2>
			<p>Researchers have suggested that the use of deep learning models without considering the inherent bias in the training data can lead not only to poorly performing solutions but also to ethical complications.</p>
			<p>For instance, in late 2016, researchers from the Shanghai Jiao Tong University in China created a neural network that correctly classified criminals using only pictures of their faces. The researchers used 1,856 images of Chinese men, of which half had been convicted. Their model identified inmates with 89.5% accuracy.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To know more about this, refer to <a href="https://blog.keras.io/the-limitations-of-deep-learning.html">https://blog.keras.io/the-limitations-of-deep-learning.html</a> and <em class="italic">MIT Technology Review. Neural Network Learns to Identify Criminals by Their Faces</em>, <em class="italic">November 22, 2016</em>, available at <a href="https://www.technologyreview.com/2016/11/22/107128/neural-network-learns-to-identify-criminals-by-their-faces/">https://www.technologyreview.com/2016/11/22/107128/neural-network-learns-to-identify-criminals-by-their-faces/</a>.</p>
			<p class="callout">The paper resulted in a great furor within the scientific community and popular media. One key issue with the proposed solution is that it fails to properly recognize the bias inherent in the input data. Namely, the data used in this study came from two different sources: one for criminals and one for non-criminals. Some researchers suggest that their algorithm identifies patterns associated with the different data sources used in the study instead of identifying relevant patterns from people's faces. While there are technical considerations that we can make about the reliability of the model, the key criticism is on ethical grounds: researchers ought to clearly recognize the inherent bias in input data used by deep learning algorithms and consider how its application will impact on people's lives. <em class="italic">Timothy Revell. Concerns as face recognition tech used to 'identify' criminals. New Scientist. December 1, 2016. Available at:</em> <a href="https://www.newscientist.com/article/2114900-concerns-as-face-recognition-tech-used-to-identify-crim">https://www.newscientist.com/article/2114900-concerns-as-face-recognition-tech-used-to-identify-criminals/</a>.</p>
			<p>There are different types of biases that can occur in a dataset. Consider a case where you are building an automatic surveillance system that can operate both in the daytime and nighttime. So, if your dataset just included images from the daytime, then you would be introducing a sample bias in the model. This could be eliminated by including nighttime data and covering all the different types of cases possible, such as images from a sunny day, a rainy day, and so on. Another example to consider is where, let's suppose, a similar kind of system is installed in a workplace to analyze the workers and their activities. Now, if your model has been fed with thousands of examples with men coding and women cooking, then this data clearly reflects stereotypes. A solution to this problem is the same as earlier: to expose the model to data that is more evenly distributed.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To find out more about the topic of ethics in learning algorithms (including deep learning), refer to the work done by the AI Now Institute (<a href="https://ainowinstitute.org/">https://ainowinstitute.org/</a>), an organization created for the understanding of the social implications of intelligent systems.</p>
			<h2 id="_idParaDest-27"><a id="_idTextAnchor027"/>Common Components and Operations of Neural Networks</h2>
			<p>Neural networks have two key components: layers and nodes.</p>
			<p>Nodes are responsible for specific operations, and layers are groups of nodes that differentiate different stages of the system. Typically, neural networks are comprised of the following three layers:</p>
			<ul>
				<li><strong class="bold">Input layer</strong>: Where the input data is received and interpreted</li>
				<li><strong class="bold">Hidden layer</strong>: Where computations take place, modifying the data as it passes through</li>
				<li><strong class="bold">Output layer</strong>: Where the output is assembled and evaluated</li>
			</ul>
			<p>The following figure displays the working of layers of neural networks:</p>
			<div>
				<div id="_idContainer011" class="IMG---Figure">
					<img src="image/B15911_01_02.jpg" alt="Figure 1.2: An illustration of the most common layers in a neural network&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.2: An illustration of the most common layers in a neural network</p>
			<p>Hidden layers are the most important layers in neural networks. They are referred to as <em class="italic">hidden</em> because the representations generated in them are not available in the data, but are learned from it instead. It is within these layers where the main computations take place in neural networks.</p>
			<p>Nodes are where data is represented in the network. There are two values associated with nodes: biases and weights. Both values affect how data is represented by the nodes and passed on to other nodes. When a network <em class="italic">learns</em>, it effectively adjusts these values to satisfy an optimization function.</p>
			<p>Most of the work in neural networks happens in the hidden layers. Unfortunately, there isn't a clear rule for determining how many layers or nodes a network should have. When implementing a neural network, you will probably spend time experimenting with different combinations of layers and nodes. It is advisable to always start with a single layer and also with a number of nodes that reflect the number of features the input data has (that is, how many <em class="italic">columns</em> are available in a given dataset). </p>
			<p>You can continue to add layers and nodes until a satisfactory performance is achieved—or whenever the network starts overfitting to the training data. Also, note that this depends very much on the dataset – if you were training a model to recognize hand-drawn digits, then a neural network with two hidden layers would be enough, but if your dataset was more complex, say for detecting objects like cars and ambulance in images, then even 10 layers would not be enough and you would need to have a deeper network for the objects to be recognized correctly. </p>
			<p>Likewise, if you were using a network with 100 hidden layers for training on handwritten digits, then there would be a strong possibility that you would overfit the model, as that much complexity would not be required by the model in the first place.</p>
			<p>Contemporary neural network practice is generally restricted to experimentation with the number of nodes and layers (for example, how deep the network is), and the kinds of operations performed at each layer. There are many successful instances in which neural networks outperformed other algorithms simply by adjusting these parameters.</p>
			<p>To start off with, think about data entering a neural network system via the input layer, and then moving through the network from node to node. The path that data takes will depend on how interconnected the nodes are, the weights and the biases of each node, the kind of operations that are performed in each layer, and the state of the data at the end of such operations. Neural networks often require many <strong class="bold">runs</strong> (or epochs) in order to keep tuning the weights and biases of nodes, meaning that data flows over the different layers of the graph multiple times.</p>
			<h1 id="_idParaDest-28"><a id="_idTextAnchor028"/>Configuring a Deep Learning Environment</h1>
			<p>Before we finish this chapter, we want you to interact with a real neural network. We will start by covering the main software components used throughout this book and make sure that they are properly installed. We will then explore a pre-trained neural network and explore a few of the components and operations discussed in the <em class="italic">What are Neural Networks?</em> section.</p>
			<h2 id="_idParaDest-29"><a id="_idTextAnchor029"/>Software Components for Deep Learning</h2>
			<p>We'll use the following software components for deep learning:</p>
			<h3 id="_idParaDest-30"><a id="_idTextAnchor030"/>Python 3</h3>
			<p>We will be using Python 3 in this book. Python is a general-purpose programming language that is very popular with the scientific community—hence its adoption in deep learning. Python 2 is not supported in this book but can be used to train neural networks instead of Python 3. Even if you chose to implement your solutions in Python 2, consider moving to Python 3 as its modern feature set is far more robust than that of its predecessor.</p>
			<h3 id="_idParaDest-31"><a id="_idTextAnchor031"/>TensorFlow</h3>
			<p>TensorFlow is a library used for performing mathematical operations in the form of graphs. TensorFlow was originally developed by Google, and today, it is an open source project with many contributors. It has been designed with neural networks in mind and is among the most popular choices when creating deep learning algorithms.</p>
			<p>TensorFlow is also well known for its production components. It comes with TensorFlow Serving (<a href="https://github.com/tensorflow/serving">https://github.com/tensorflow/serving</a>), a high-performance system for serving deep learning models. Also, trained TensorFlow models can be consumed in other high-performance programming languages such as Java, Go, and C. This means that you can deploy these models on anything from a micro-computer (that is, a Raspberry Pi) to an Android device. As of November 2019, TensorFlow version 2.0 is the latest version.</p>
			<h3 id="_idParaDest-32"><a id="_idTextAnchor032"/>Keras</h3>
			<p>In order to interact efficiently with TensorFlow, we will be using Keras (<a href="https://keras.io/">https://keras.io/</a>), a Python package with a high-level API for developing neural networks. While TensorFlow focuses on components that interact with each other in a computational graph, Keras focuses specifically on neural networks. Keras uses TensorFlow as its backend engine and makes developing such applications much easier.</p>
			<p>As of November 2019, Keras is the built-in and default API of TensorFlow. It is available under the <strong class="source-inline">tf.keras</strong> namespace. </p>
			<h3 id="_idParaDest-33"><a id="_idTextAnchor033"/>TensorBoard</h3>
			<p>TensorBoard is a data visualization suite for exploring TensorFlow models and is natively integrated with TensorFlow. TensorBoard works by consuming the checkpoint and summary files created by TensorFlow as it trains a neural network. Those can be explored either in near real time (with a 30-second delay) or after the network has finished training. TensorBoard makes the process of experimenting with and exploring a neural network much easier—plus, it's quite exciting to follow the training of your network.</p>
			<h3 id="_idParaDest-34"><a id="_idTextAnchor034"/>Jupyter Notebook, Pandas, and NumPy</h3>
			<p>When working to create deep learning models with Python, it is common to start working interactively; slowly developing a model that eventually turns into more structured software. Three Python packages are used frequently during this process: Jupyter Notebooks, Pandas, and NumPy:</p>
			<ul>
				<li>Jupyter Notebook create interactive Python sessions that use a web browser as their interface.</li>
				<li>Pandas is a package for data manipulation and analysis.</li>
				<li>NumPy is frequently used for shaping data and performing numerical computations.</li>
			</ul>
			<p>These packages are used occasionally throughout this book. They typically do not form part of a production system but are often used when exploring data and starting to build a model. We'll focus on the other tools in much more detail.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The books <em class="italic">Learning pandas</em> by Michael Heydt (June 2017, Packt Publishing), available at <a href="https://www.packtpub.com/big-data-and-business-intelligence/learning-pandas-second-edition">https://www.packtpub.com/big-data-and-business-intelligence/learning-pandas-second-edition</a>, and <em class="italic">Learning Jupyter</em> by Dan Toomey (November 2016, Packt Publishing), available at <a href="https://www.packtpub.com/big-data-and-business-intelligence/learning-jupyter-5-second-edition">https://www.packtpub.com/big-data-and-business-intelligence/learning-jupyter-5-second-edition</a>, both offer comprehensive guides on how to use these technologies. These books are good references for continuing to learn more.</p>
			<p>The following table details the software requirements required for successfully creating the deep learning models explained in this book:</p>
			<div>
				<div id="_idContainer012" class="IMG---Figure">
					<img src="image/B15911_01_03.jpg" alt="Figure 1.3: The software components necessary for creating a deep learning environment&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.3: The software components necessary for creating a deep learning environment</p>
			<p>Anaconda is a free distribution of many useful Python packages for Windows, Mac or other platform. We recommend that you follow the instructions at <a href="https://docs.anaconda.com/anaconda/install/">https://docs.anaconda.com/anaconda/install/</a>. The standard Anaconda installation will install most of these components and the first exercise will work through how to install the others.</p>
			<h2 id="_idParaDest-35"><a id="_idTextAnchor035"/>Exercise 1.01: Verifying the Software Components</h2>
			<p>Before we explore a trained neural network, let's verify whether all the software components that we need are available. We have included a script that verifies whether these components work. Let's take a moment to run the script and deal with any eventual problems we may find. We will now be testing whether the software components required for this book are available in your working environment. First, we suggest the creation of a Python virtual environment using Python's native module <strong class="source-inline">venv</strong>. Virtual environments are used for managing project dependencies. We suggest each project you create has its own virtual environment.</p>
			<ol>
				<li>A python virtual environment can be created by using the following command:<p class="source-code">$ python -m venv venv</p><p class="source-code">$ source venv/bin/activate</p><p>The latter command will append the string <strong class="source-inline">venv</strong> at the beginning of the command line.</p><p>Make sure you always activate your Python virtual environment when working on a project. To deactivate your virtual environment, run <strong class="source-inline">$ deactivate</strong>.</p></li>
				<li>After activating your virtual environment, make sure that the right components are installed by executing <strong class="source-inline">pip</strong> over the <strong class="source-inline">requirements.txt</strong> file (<a href="https://packt.live/300skHu">https://packt.live/300skHu</a>). <p class="source-code">$ pip install –r requirements.txt</p><p>The output is as follows:</p><div id="_idContainer013" class="IMG---Figure"><img src="image/B15911_01_04.jpg" alt="Figure 1.4: A screenshot of a Terminal running pip to install dependencies from requirements.txt&#13;&#10;"/></div><p class="figure-caption">Figure 1.4: A screenshot of a Terminal running pip to install dependencies from requirements.txt</p></li>
				<li>This will install the libraries used in this book in that virtual environment. It will do nothing if they are already available. If the library is getting installed, a progress bar will be shown, else it will notify that '<strong class="source-inline">requirement is already specified</strong>'. To check the available libraries installed, please use the following command:<p class="source-code">$ pip list</p><p>The output will be as follows: </p><div id="_idContainer014" class="IMG---Figure"><img src="image/B15911_01_05.jpg" alt="Figure 1.5: A screenshot of a Terminal running pip to list the available libraries&#13;&#10;"/></div><p class="figure-caption">Figure 1.5: A screenshot of a Terminal running pip to list the available libraries</p><p class="callout-heading">Note</p><p class="callout">These libraries are essential for working with all the code activities in this book.</p></li>
				<li>As a final step in this exercise, execute the script <strong class="source-inline">test_stack.py</strong>. This can be found at: <a href="https://packt.live/2B0JNau">https://packt.live/2B0JNau</a> It verifies that all the required packages for this book are installed and available in your system.</li>
				<li>Run the following script to check if the dependencies of Python 3, TensorFlow, and Keras are available. Use the following command:<p class="source-code">$ python3 Chapter01/Exercise1.01/test_stack.py</p><p>The script returns helpful messages stating what is installed and what needs to be installed:</p><div id="_idContainer015" class="IMG---Figure"><img src="image/B15911_01_06.jpg" alt="Figure 1.6: A screenshot of a Terminal displaying that not all the requirements are installed&#13;&#10;"/></div><p class="figure-caption">Figure 1.6: A screenshot of a Terminal displaying that not all the requirements are installed</p><p>For example, in the preceding screenshot, it shows that TensorFlow 2.0 is not detected but Keras 2.2 or higher is detected. Hence you are shown the error message <strong class="source-inline">Please review software requirements before proceeding to Lesson 2</strong>. If all the requirements are fulfilled, then it will show Python, TensorFlow, and Keras as installed, as shown in the following screenshot:</p><div id="_idContainer016" class="IMG---Figure"><img src="image/B15911_01_07.jpg" alt="Figure 1.7: A screenshot of the Terminal displaying that all elements are installed &#13;&#10;"/></div><p class="figure-caption">Figure 1.7: A screenshot of the Terminal displaying that all elements are installed </p></li>
				<li>Run the following script command in your Terminal to find more information on how to configure TensorBoard:<p class="source-code">$ tensorboard –help</p><p>The output is as follows:</p></li>
			</ol>
			<div>
				<div id="_idContainer017" class="IMG---Figure">
					<img src="image/B15911_01_08.jpg" alt="Figure 1.8: An output of the --help command&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.8: An output of the --help command</p>
			<p>You should see the relevant help messages that explain what each command does, as in <em class="italic">Figure 1.8</em>. </p>
			<p>As you can see in the figure above, the script returns messages informing you that all dependencies are installed correctly.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To access the source code for this specific section, please refer to <a href="https://packt.live/2B0JNau">https://packt.live/2B0JNau</a>.</p>
			<p class="callout">This section does not currently have an online interactive example, and will need to be run locally.</p>
			<p>Once we have verified that Python 3, TensorFlow, Keras, TensorBoard, and the packages outlined in <strong class="source-inline">requirements.txt</strong> have been installed, we can continue to a demo on how to train a neural network and then go on to explore a trained network using these same tools.</p>
			<h1 id="_idParaDest-36"><a id="_idTextAnchor036"/>Exploring a Trained Neural Network</h1>
			<p>In this section, we'll explore a trained neural network. We'll do this to understand how a neural network solves a real-world problem (predicting handwritten digits) and to get familiar with the TensorFlow API. When exploring this neural network, we will recognize many components introduced in previous sections, such as nodes and layers, but we will also see many that we don't recognize (such as activation functions); we will explore those in further sections. We will then walk through an exercise on how that neural network was trained and then train that same network ourselves.</p>
			<p>The network that we will be exploring has been trained to recognize numerical digits (integers) using images of handwritten digits. It uses the MNIST dataset (<a href="http://yann.lecun.com/exdb/mnist/">http://yann.lecun.com/exdb/mnist/</a>), a classic dataset frequently used for exploring pattern recognition tasks.</p>
			<h2 id="_idParaDest-37"><a id="_idTextAnchor037"/>The MNIST Dataset</h2>
			<p>The <strong class="bold">Modified National Institute of Standards and Technology</strong> (<strong class="bold">MNIST</strong>) dataset contains a training set of 60,000 images and a test set of 10,000 images. Each image contains a single handwritten number. This dataset, which is derived from one created by the US Government, was originally used to test different approaches to the problem of recognizing handwritten text by computer systems. Being able to do that was important for the purpose of increasing the performance of postal services, taxation systems, and government services. The MNIST dataset is considered too naïve for contemporary methods. Different and more recent datasets are used in contemporary research (for example, <strong class="bold">Canadian Institute for Advanced Research</strong> (<strong class="bold">CIFAR</strong>). However, the MNIST dataset is still very useful for understanding how neural networks work because known models can achieve a high level of accuracy with great efficiency.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The CIFAR dataset is a machine learning dataset that contains images organized in different classes. Different than the MNIST dataset, the CIFAR dataset contains classes from many different areas including animals, activities, and objects. The CIFAR dataset is available at <a href="https://www.cs.toronto.edu/~kriz/cifar.html">https://www.cs.toronto.edu/~kriz/cifar.html</a>.</p>
			<p>However, the MNIST dataset is still very useful for understanding how neural networks work because known models can achieve a high level of accuracy with great efficiency. In the following figure, each image is a separate 20x20-pixel image containing a single handwritten digit. You can find the original dataset at <a href="http://yann.lecun.com/exdb/mnist/">http://yann.lecun.com/exdb/mnist/</a>.</p>
			<div>
				<div id="_idContainer018" class="IMG---Figure">
					<img src="image/B15911_01_09.jpg" alt="Figure 1.9: An excerpt from the training set of the MNIST dataset&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.9: An excerpt from the training set of the MNIST dataset</p>
			<h2 id="_idParaDest-38"><a id="_idTextAnchor038"/>Training a Neural Network with TensorFlow</h2>
			<p>Now, let's train a neural network to recognize new digits using the MNIST dataset. We will be implementing a special-purpose neural network called a <strong class="bold">Convolutional Neural Network</strong>(<strong class="bold">CNN</strong>) to solve this problem (we will discuss those in more detail in later sections). Our complete network contains three hidden layers: two fully connected layers and a convolutional layer. The model is defined by the following TensorFlow snippet of Python code:</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The code snippet shown here uses a backslash ( <strong class="source-inline">\</strong> ) to split the logic across multiple lines. When the code is executed, Python will ignore the backslash, and treat the code on the next line as a direct continuation of the current line.</p>
			<p class="source-code">model = Sequential()</p>
			<p class="source-code">model.add(Convolution2D(filters = 10, kernel_size = 3, \</p>
			<p class="source-code">                        input_shape=(28,28,1)))</p>
			<p class="source-code">model.add(Flatten())</p>
			<p class="source-code">model.add(Dense(128, activation = 'relu'))</p>
			<p class="source-code">model.add(Dropout(0.2))</p>
			<p class="source-code">model.add(Dense(10, activation = 'softmax'))</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Use the <strong class="source-inline">mnist.py</strong> file for your reference at <a href="https://packt.live/2Cuhj9w">https://packt.live/2Cuhj9w</a>. Follow along by opening the script in your code editor.</p>
			<p>We execute the preceding snippet of code only once during the training of our network.</p>
			<p>We will go into a lot more detail about each one of those components using Keras in <em class="italic">Chapter 2</em>, <em class="italic">Real-World Deep Learning with TensorFlow and Keras: Predicting the Price of Bitcoin</em>. For now, we'll focus on understanding that the network is altering the values of the <strong class="source-inline">Weights</strong> and <strong class="source-inline">Biases</strong> in each layer on every run. These lines of Python are the culmination of dozens of years of neural network research.</p>
			<p> Now let's train that network to evaluate how it performs in the MNIST dataset.</p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor039"/>Exercise 1.02: Training a Neural Network Using the MNIST Dataset</h2>
			<p>In this exercise, we will train a neural network for detecting handwritten digits from the MNIST dataset. Execute the following steps to set up this exercise:</p>
			<ol>
				<li value="1">Open two Terminal instances.</li>
				<li>Navigate to <a href="https://packt.live/2BWNAWK">https://packt.live/2BWNAWK</a>. Ensure that your Python 3 virtual environment is active and that the requirements outlined in <strong class="source-inline">requirements.txt</strong> are installed.</li>
				<li>In one of them, start a TensorBoard server with the following command:<p class="source-code">$ tensorboard --logdir logs/fit</p><p>The output is as follows:</p><div id="_idContainer019" class="IMG---Figure"><img src="image/B15911_01_10.jpg" alt="Figure 1.10: The TensorBoard server&#13;&#10;"/></div><p class="figure-caption">Figure 1.10: The TensorBoard server</p><p>In the other, run the <strong class="source-inline">mnist.py</strong> script from within that directory with the following command:</p><p class="source-code">$ python mnist.py</p><p>When you start running the script, you will see the progress bar as follows:</p><div id="_idContainer020" class="IMG---Figure"><img src="image/B15911_01_11.jpg" alt="Figure 1.11: The result of the mnist.py script&#13;&#10;"/></div><p class="figure-caption">Figure 1.11: The result of the mnist.py script</p></li>
				<li>Open your browser and navigate to the TensorBoard URL provided when you start the server in <em class="italic">step 3</em>, it might be <strong class="source-inline">http://localhost:6006/</strong> or similar. In the Terminal where you ran the <strong class="source-inline">mnist.py</strong> script, you will see a progress bar with the epochs of the model. When you open the browser page, you will see a couple of graphs, <strong class="source-inline">epoch_accuracy</strong> and <strong class="source-inline">epoch_loss</strong> graphs. Ideally, the accuracy should improve with each iteration and the loss should decrease with each iteration. You can confirm this visually with the graphs. </li>
				<li>Click the <strong class="source-inline">epoch_accuracy</strong> graph, enlarge it, and let the page refresh (or click on the <strong class="source-inline">refresh</strong> icon). You will see the model gaining accuracy as the epochs go by:</li>
			</ol>
			<div>
				<div id="_idContainer021" class="IMG---Figure">
					<img src="image/B15911_01_12.jpg" alt="Figure 1.12: A visualization of the accuracy and loss graphs using TensorBoard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.12: A visualization of the accuracy and loss graphs using TensorBoard</p>
			<p>We can see that after about 5 epochs (or steps), the network surpassed 97% accuracy. That is, the network is getting 97% of the digits in the test set correct by this point.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To access the source code for this specific section, please refer to <a href="https://packt.live/2Cuhj9w">https://packt.live/2Cuhj9w</a>.</p>
			<p class="callout">This section does not currently have an online interactive example, and will need to be run locally.</p>
			<p>Now, let's also test how well those networks perform with unseen data.</p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor040"/>Testing Network Performance with Unseen Data</h2>
			<p>Visit the website <a href="http://mnist-demo.herokuapp.com/">http://mnist-demo.herokuapp.com/</a> in your browser and draw a number between 0 and 9 in the designated white box:</p>
			<div>
				<div id="_idContainer022" class="IMG---Figure">
					<img src="image/B15911_01_13.jpg" alt="Figure 1.13: A web application for manually drawing digits and testing the accuracy of two trained networks&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.13: A web application for manually drawing digits and testing the accuracy of two trained networks</p>
			<p class="callout-heading">Note</p>
			<p class="callout">This web application we are using was created by <em class="italic">Shafeen Tejani</em> to explore whether a trained network can correctly predict handwritten digits that we create.</p>
			<p class="callout">Source: <a href="https://github.com/ShafeenTejani/mnist-demo">https://github.com/ShafeenTejani/mnist-demo</a>.</p>
			<p>In the application, you can see the results of two neural networks – a <strong class="bold">Convolutional Neural Network</strong> (<strong class="bold">CNN</strong>) and a <strong class="bold">Fully Connected Neural Network</strong>. The one that we have trained is the CNN. Does it classify all your handwritten digits correctly? Try drawing numbers at the edge of the designated area. For instance, try drawing the number <strong class="source-inline">1</strong> close to the right edge of the drawing area, as shown in the following figure:</p>
			<div>
				<div id="_idContainer023" class="IMG---Figure">
					<img src="image/B15911_01_14.jpg" alt="Figure 1.14: Both networks have a difficult time estimating values drawn on &#13;&#10;the edges of the area&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.14: Both networks have a difficult time estimating values drawn on the edges of the area</p>
			<p>In this example, we see the number 1 drawn to the right side of the drawing area. The probability of this number being a 1 is 0 in both networks.</p>
			<p>The MNIST dataset does not contain numbers on the edges of images. Hence, neither network assigns relevant values to the pixels located in that region. Both networks are much better at classifying numbers correctly if we draw them closer to the center of the designated area. This is due to the fact that in the training set, we only had images with numbers drawn in the center of the image. This shows that neural networks can only be as powerful as the data that is used to train them. If the data used for training is very different than what we are trying to predict, the network will most likely produce disappointing results.</p>
			<h2 id="_idParaDest-41"><a id="_idTextAnchor041"/>Activity 1.01: Training a Neural Network with Different Hyperparameters</h2>
			<p>In this section, we will explore the neural network that we trained during our work on <em class="italic">Exercise 1.02</em>, <em class="italic">Training a Neural Network Using the MNIST Dataset</em>, where we trained our own CNN on the MNIST dataset. We have provided that same trained network as binary files in the directory of this book. In this activity, we will just cover the things that you can do using TensorBoard and we will train several other networks by just changing some hyperparameters.</p>
			<p>Here are the steps you need to follow:</p>
			<ol>
				<li value="1">Open TensorBoard by writing the appropriate command.</li>
				<li>Open the TensorBoard accuracy graph and play with the values of smoothening sliders in scalar areas.</li>
				<li>Train another model by changing the hyperparameters.</li>
				<li>Try decreasing the learning rate and increasing the number of epochs.</li>
				<li>Now try to understand what effect this hyperparameter tuning has on the graphs generated on TensorBoard.</li>
				<li>Try increasing the learning rate and decreasing the number of epochs and repeat <em class="italic">step 5</em>.<p class="callout-heading">Note:</p><p class="callout">The solution for this activity can be found on page 130.</p></li>
			</ol>
			<h1 id="_idParaDest-42"><a id="_idTextAnchor042"/>Summary</h1>
			<p>In this chapter, we explored a TensorFlow-trained neural network using TensorBoard and trained our own modified version of that network with different epochs and learning rates. This gave you hands-on experience of how to train a highly performant neural network and allowed you to explore some of its limitations.</p>
			<p>Do you think we can achieve similar accuracy with real Bitcoin data? We will attempt to predict future Bitcoin prices using a common neural network algorithm in <em class="italic">Chapter 2</em>, <em class="italic">Real-World Deep Learning with TensorFlow and Keras: Predicting the Price of Bitcoin</em>. In <em class="italic">Chapter 3</em>, <em class="italic">Real-World Deep Learning with TensorFlow and Keras: Evaluating the Bitcoin Model</em>, we will evaluate and improve that model, and finally, in <em class="italic">Chapter 4</em>, <em class="italic">Productization</em>, we will create a program that serves the prediction of that system via an HTTP API.</p>
		</div>
		<div>
			<div id="_idContainer025" class="Basic-Text-Frame">
			</div>
		</div>
		<div>
			<div id="_idContainer026" class="Content">
			</div>
		</div>
	</body></html>