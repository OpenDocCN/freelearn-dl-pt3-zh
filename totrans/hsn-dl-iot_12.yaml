- en: Deep Learning in Healthcare IoT
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The IoT has diverse application domains, including health and medical care.
    Use of IoT in healthcare is growing at a dangerously fast pace, and market research
    shows that the global IoT healthcare market could reach US $534.3 billion by 2025\.
    Most of these applications, including remote and real-time patient monitoring,
    will generate heterogeneous, streaming, and/or big data. However, analyzing and
    extracting useful information from this data is a challenging task for medical
    and healthcare professionals. In this context, **machine learning** (**ML**) and
    **deep learning** (**DL**) models can address the challenge by automated analysis,
    classification of various data, and detection of anomalies within data. The healthcare
    industry is extensively using ML and DL for various applications. Hence, the use
    of ML/DL models in IoT healthcare applications is a necessity for the true realization
    of healthcare IoT.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we present DL-based IoT solutions for healthcare in general.
    In the first part of the chapter, we will present an overview of the various applications
    of IoT in healthcare. Then, we will briefly discuss two use cases where healthcare
    services can be improved and/or automatized through DL-supported IoT solutions.
    In the second part of the chapter, we will present hands-on experience of the
    DL-based healthcare incident and/or diseases detection part of the two use cases.
    In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: IoT and healthcare applications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Use case one: remote chronic disease management'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implementation of remote chronic disease management
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Use case two: IoT for acne detection and care'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implementation of acne detection and care
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DL for IoT in healthcare
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CNN and LSTM in IoT healthcare applications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data collection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data preprocessing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Model training
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Evaluation of the models
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IoT in healthcare
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Globally, health and medical care services are facing tremendous challenges
    owing to, for example, soaring costs, an ageing population, an increase in the
    prevalence of chronic and/or multiple conditions, and a shortage of skilled healthcare
    professionals. In addition, traditional care services relying on average and/or
    qualitative data and a one-size-fits-all prescribing approach do not work well.
    In this context, the use of IoT in healthcare services addresses many of these
    challenges by offering the following features:'
  prefs: []
  type: TYPE_NORMAL
- en: Seamless integration with various existing technologies
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Support of big data processing and analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Personalized services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Remote and real-time monitoring-based connected healthcare services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Quantitative data, which offer more effective services than qualitative data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Interactive and real-time interaction between healthcare professionals and patients
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ubiquitous access to services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Efficient management of healthcare resources
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'All these features of the IoT-based solutions will disrupt the healthcare industry
    by offering various services. These services can be viewed and served in two different
    environments:'
  prefs: []
  type: TYPE_NORMAL
- en: Hospital and clinics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Non-clinical patient environments
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following diagram highlights a few main applications of these two environments
    and presents a list of potential services in each of the environments:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/67da9769-c4a9-4793-b631-f0db4541f3f5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following are the key subdomains of IoT healthcare:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Smart hospitals**: Globally, in both developed and developing countries,
    hospitals are overcrowded with patients. Also, they have a shortage of resources—including
    skilled professionals—and equipment. The situation is really bad in rural areas
    of most countries, where people have limited or no access to healthcare facilities.
    In this context, IoT-based remote services, such as remote monitoring and telemedicine,
    can offer access to many basic healthcare services. Also, remote monitoring of
    elderly patients and those with chronic diseases can greatly reduce healthcare-related
    costs, and improve quality of life for both patients and healthcare professionals.
    Smart and connected ambulances can offer on-fleet prompt and emergency services,
    and reduce emergency services-related incidents. In an operating room, connected
    doctors (locally and externally), staff, and medical devices can offer a better
    and smoother operating environment. Also, inventory management in hospitals can
    be greatly improved through IoT applications.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Clinics**: Many people go to a **general practitioner** **(****GP)** practice
    or clinic for primary care services. These service providers can also benefit
    from using IoT applications. For example, a GP can view and analyze virtually
    the patient''s pathology report, which saves time for both parties. Importantly,
    patients will get more time for care-related discussions than information gathering.
    Clinics can verify insurance coverage for patients in real time. Appointment management
    in clinics and GP practices is a global challenge. In England, approximately 15
    million appointments per year are missed, which costs the **National Health Service**
    (**NHS**) millions of pounds. This situation can be improved by IoT-based applications.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Non-clinical patient environments**: Two potential application areas of IoT
    could be connected—the patient and the smart home. Here, the smart home would
    offer healthcare services to patients anytime and anywhere. Remote monitoring
    of a prescribed intervention, such as physiotherapy, can be done through a connected
    patient application. Also, patients can get personalized services, such as reminders
    to take medication. Offering monitoring and healthcare services to elderly people
    is a great challenge worldwide. Smart home solutions can improve existing services
    and offer new services for these highly vulnerable people through fall detection,
    medication reminders, telemedicine, and general assisted living.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It is clear from the preceding discussion that IoT has huge potential in healthcare
    domains. In the following section, we will briefly discuss two use cases of IoT
    in healthcare.
  prefs: []
  type: TYPE_NORMAL
- en: Use case one – remote management of chronic disease
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Chronic diseases—including cardiovascular diseases, hypertension, and diabetes—cause
    over 40 million deaths per year globally. This problem has different dimensions
    in developing countries and developed countries. In developing countries, people
    with chronic diseases have limited or no access to many basic health services,
    including early or on-time detection facilities, which leads to many deaths. On
    the other hand, in developed countries, medical research has led to a significant
    increase in life expectancy. This has been achieved by means of, for example,
    early detection and monitoring of disease. However, in developed countries, including
    the UK, for every 2 years of increased life expectancy, we gain just 1 year of
    quality life. Consequently, the proportion of our lives spent with chronic diseases
    and disability is rising. The cost of managing patients with multiple chronic
    diseases is trillions of dollars/pounds. Fortunately, IoT-based remote monitoring
    of patients with chronic diseases can address most of these issues and offer cost-effective
    services.
  prefs: []
  type: TYPE_NORMAL
- en: Implementation of use case one
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We are considering an IoT-based remote patient monitoring application for use
    case one. The following diagram briefly presents how the IoT-based, remote patient
    monitoring and management system will work:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/39cdf21e-54aa-48f0-b6c3-a6da036d7a59.png)'
  prefs: []
  type: TYPE_IMG
- en: 'As shown, the IoT-based, remote patient monitoring system consists of three
    main elements, namely, smart home, care providers, and Health Cloud:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Smart home**: This is the heart of the solution, and includes the patient
    and various devices for the IoT solutions. The smart home consists of the following
    key components:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Patient**: A patient will be attached to multiple sensors, including an **electrocardiogram (ECG)**,
    blood pressure sensor, accelerometer, and gyroscope. These sensors will collect
    physiological and activity-related data and send them to the care providers for
    necessary and real-time feedback.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ambient sensing**: Body sensors and wearable devices are not sufficient to
    cover all of the activities of the patient. Also, patients do not feel comfortable
    with too many sensors on their body for many reasons, including the need for seamless
    movement. The smart home will be installed with various ambient sensors, including
    light, vibration, motion, pressure, and door sensors. These sensors will provide
    contextual information about the patient.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Edge computing platform**: We have various options for this component, for
    example, a smartphone/tablet, edge gateway, or a Raspberry Pi 3\. For this use
    case, we are considering a Raspberry Pi 3\. All the sensors mentioned earlier
    can be connected to the Raspberry Pi 3\. Most will sense the environment and/or
    patient''s activity continuously, and others will be event-driven (for example,
    the door sensor will be activated if someone opens or knocks on the door). These
    sensors will send data to the Raspberry Pi 3 for further processing, including
    detecting events such as high blood pressure or body temperature, or a fall. Finally,
    this processed data will be sent to the care providers through the home router,
    and Health Cloud. Importantly, the Raspberry Pi 3 will be installed with various
    pretrained DL/ML models, including an ECG measurement classifier for detection
    of any heart-related anomalies.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Health Cloud for model learning and data analysis:** The Health Cloud is
    a cloud computing platform, mainly designed for healthcare-related services, and
    is mainly responsible for the following:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DL model training
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Data analysis
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The model training component will train the necessary DL models for categorizing
    or classifying a variety of physiological signals from the patient and contextual
    data to make informed decisions. The Health Cloud will receive various data from
    the Raspberry Pi 3, and some of them may conflict with each other. In this context,
    a data analysis tools will analyze and present the data to the healthcare professionals
    for decision making.
  prefs: []
  type: TYPE_NORMAL
- en: '**Care providers**: Care providers can be hospitals or clinics that provide
    care services. As many patients have multiple chronic diseases, most need to be
    directly or indirectly connected with more than one specialized doctor. Once the
    doctor receives information about the patient and their environment, they will
    make a decision with the support of other data, including historical data from
    an **electronic health record (EHR)**. Once the decision has been made, it will
    be sent back to the patient and, if necessary, a decision will be actuated through
    the appropriate devices (such as an insulin pump) connected to the patient.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ECG-based health checking of the heart is an essential element of the above
    use case. In the second part of the chapter, we will describe implementation of
    the DL-based ECG measurement classification of the preceding use case.
  prefs: []
  type: TYPE_NORMAL
- en: Use case two – IoT for acne detection and care
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Acne is one of the world''s most common skin conditions. Most people, at some
    point in their lifetime, are affected by acne. Generally, acne develops on the
    face and appears as spots (as shown in the following diagram) and oily skin. Sometimes,
    the skin can become hot or painful to the touch. Acne can manifest as whiteheads,
    blackheads, pustules, papules, cysts, and nodules. The first three are also known
    as pimples. Different types of acne need different treatments and care; therefore,
    detection and automated classification of acne could be useful. Acne can be confused
    with one of three similar conditions—rosacea, eczema, or allergic reaction—because
    patients often self-diagnose and treat. Incorrect diagnosis and treatment can
    make the condition worse. The following diagram shows two examples of what acne
    can look like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/462bc10c-3fce-4d56-bd9d-f1b8da31dd06.png)'
  prefs: []
  type: TYPE_IMG
- en: Generally, acne is not only a physical health issue, but also a mental health
    issue for many affected people. According to research, acne is significantly linked
    with depression. In a study published in the *British Journal of Dermatology*,
    researchers analyzing the records of patients with acne between 1986 and 2012
    in the UK made a strong claim about the mental health issues these patients. They
    concluded that patients with acne have a 63% higher risk of developing depression
    compared with patients who did not have acne.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will present an innovative solution using IoT and DL modes
    to address the acne detection/diagnosis problem.
  prefs: []
  type: TYPE_NORMAL
- en: Implementation of use case two
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Most people with acne and related skin conditions use a mirror to detect acne
    and monitor the progress of treatment. Therefore, the innovative idea is to create
    a smart and connected mirror to help the user detect and identify skin (mainly
    facial) anomalies, including acne.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following diagram presents an IoT infrastructure for the implementation
    of automated acne detection, classification, and care services:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ac01b78e-eb75-47d6-b1e2-c9ceb7318ff4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'As shown in the diagram, the IoT-based automated acne detection, classification,
    and care system consists of three main elements—a smart mirror, care providers,
    and the Health Cloud:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Smart mirror**: This is the heart of the solution, and includes the following
    three components:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Camera**: The mirror features a high-resolution camera embedded in such a
    way that it will be able to capture facial images. There will be a button in the
    mirror that will activate the detection process, as a patient might not always
    be interested or in need of the service. The mirror will also have a small display
    to present the results and/or suggested treatment for the acne from care providers.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Edge computing platform**: We have various options for this component, including
    a smartphone/tablet, edge gateway, or a Raspberry Pi 3\. For this use case, we
    are considering a Raspberry Pi 3 that will be connected to the camera. Once it
    receives the images, it will detect any skin-related issue, including acne, with
    the support of a preinstalled DL model. Finally, the Raspberry Pi 3 will send
    the detection results, along with the images, to a care provider to obtain treatment
    suggestions. Also, a model can be incorporated in the Raspberry Pi 3 (not within
    the scope of this book) that will analyze facial images for potential depression
    detection and corresponding support from a psychiatrist.'
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Health Cloud for model learning and data**: The Health Cloud is a cloud computing
    platform mainly designed for healthcare-related services. This cloud platform
    will be used to train the DL model for the image-based detection and classification
    of acne and other skin conditions. The Health Cloud is also responsible for updating
    any preinstalled model in the Raspberry Pi 3 or IoT devices.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Care providers**: Care providers can be hospitals and clinics that provide
    care services. As acne might cause depression, we are considering two potential
    doctors—a dermatologist for skin-related issues and a psychiatrist for depression-related
    issues. Once the doctors receive the detected information and images, they will
    make a decision with the support of other data, including historical images of
    the patient. Finally, the suggested treatment or feedback will be sent back to
    the patient.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the following sections, we will describe implementation of the DL-based solutions
    required for the aforementioned use cases. All the necessary codes are available
    in the chapter's code folder.
  prefs: []
  type: TYPE_NORMAL
- en: DL for healthcare
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DL models are evolving as the most powerful and effective computing resources
    for every industry. They are contributing significantly to the industries' value
    by improving user experience and enabling more informed decision making. Healthcare
    is one of the key application domains of DL, and DL has been further progressed
    by the increasing availability of heterogeneous healthcare data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Unlike many other industries, the health and medical industries are obtaining
    highly value-added applications in many areas, including research, innovation,
    and real-world medical environments. Many of these applications are patient-facing
    (such as early detection and prediction of cancer, and personalized medicine)
    and others are for improving the user experience in various aspects of healthcare
    IT. The following diagram highlights some of the application areas of DL in healthcare:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d9612bba-f7cd-476e-a489-92b169f7033a.png)'
  prefs: []
  type: TYPE_IMG
- en: CNN and LSTM in healthcare applications
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Healthcare applications generate big data, and they come from heterogeneous
    sources in heterogeneous formats. A large number of these, including screening
    and diagnostic data from **magnetic resonance imaging** **(MRI)**, X-ray, and
    ultrasound are in image format. Human physiological signals, such as those detected
    by **electromyography** (**EMG**), **electroencephalography** (**EEG**), ECG,
    and **electrooculography** **(EOG)**, are time series data. EHRs include structured
    (such as diagnosis, prescriptions, and laboratory tests) as well as unstructured
    (such as free-text clinical notes) clinical data. Also, high-throughput biology,
    such as genomics, produces high-dimensional data regarding human internal structures.
    All of this different healthcare data requires the support of ML—especially DL—to
    extract valuable information and gain insights into any potential issues.
  prefs: []
  type: TYPE_NORMAL
- en: A number of DL models have been used for the analysis of these heterogeneous
    healthcare data. CNN and LSTMs (RNNs) are the most widely used DL models, as their
    features work well with most healthcare data types. For example, CNN models are
    best for image processing and are used for various medical images. By contrast,
    LSTMs/RNNs are best for most physiological signals, as they have a memory feature
    to handle the temporal properties of the signals. ECG measurements are one of
    the key physiological signals in screening for cardiovascular disease. Therefore,
    the remote patient-monitoring system includes a DL-based ECG signal analyzer for
    detecting various heart conditions, such as **atrial fibrillation** (**AF**).
  prefs: []
  type: TYPE_NORMAL
- en: Considering the temporal aspect of the ECG signal, we will consider an LSTM
    for the implementation of the remote patient monitoring system. In addition, we
    will test a CNN for the ECG signal as a comparison. The IoT-based acne detection
    and care system will rely on images. Therefore, we will implement this using a
    CNN architecture. Both of these DL models have been briefly presented in chapters;
    please refer to those for an overview.
  prefs: []
  type: TYPE_NORMAL
- en: Data collection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Data collection for health and medical care applications is a challenging task
    for many reasons, including privacy and ethical issues. In this context, we have
    decided to use two different open source datasets for the two use cases.
  prefs: []
  type: TYPE_NORMAL
- en: Use case one
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The ECG dataset for use case one has been collected from 2017 PhysioNet/computing
    in cardiology challenge. This dataset consists of 8,528 ECG measurements. These
    measurements were recorded through an AliveCor hand-held device (as shown in the
    following screenshot), and, interestingly, this is an example healthcare IoT application:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b4924850-4a0a-41b9-91e9-a7c69d172df3.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The sampling rate of the ECG measurements was 300 Hz, and noise was removed
    by band-pass filtered by the AliveCor device. Each recorded measurement is compliant
    with MATLAB V4 WFDB format, and consists of two files:'
  prefs: []
  type: TYPE_NORMAL
- en: A file with a `.mat` extension that presents the main ECG signal information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A corresponding header file with a `.hea` extension that contains the waveform-related
    information of the measurement
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The dataset consists of four different classes of signals: normal rhythm, AF,
    other rhythm, or too noisy to classify. The following diagram presents a visualization
    of these different classes of the ECG signals:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/74bcce0f-4072-4a35-98ff-2b1cc7824def.png)'
  prefs: []
  type: TYPE_IMG
- en: 'AF is characterized by rapid and irregular beating of the atria and indicates
    that the heart rhythm is not normal. Other abnormal heart rhythms are considered
    as the other rhythm class. Finally, any measurements that do not reflect one of
    the three classes, as they are too noisy to be classified, are defined as a noisy
    measurement. The DL model-based classifier needs to extract these features in
    the measurements to classify the signals recorded from the patient, and the corresponding
    heart-related issues. For a better understanding and real-life implementation,
    further studies on ECG signals are necessary, which is not within the scope of
    this book. The following graph presents normal versus AF heart signal measurements:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/07d582b8-0fa1-4727-8a1b-5fc8323ea887.png)'
  prefs: []
  type: TYPE_IMG
- en: Use case two
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For the acne detection and care system use case, we are relying on an image
    dataset. We have gathered images from the *Dermnet Skin Disease Atlas*, which
    is an open-source database on various skin diseases. The database contains 23
    datasets, each on a different skin disease, and each of the categories (including
    acne and rosacea) has subcategories. The datasets are not easily downloaded as
    there are too many pages. We have written an image, or image scraper, using Python''s
    Beautiful Soup module, and we have made the scraper generic so that readers can
    test their LSTM/CNN models on the different skin diseases. The scraper `image_scraper.py`
    is available in the chapter''s code subfolder, `use-case-2`. To scrap all 23 datasets,
    run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the downloaded images folder of all types of
    skin disease:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/aed9490f-59a6-4e47-8ad9-0e6a972c5c05.png)'
  prefs: []
  type: TYPE_IMG
- en: Data exploration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the following section, we will explore the datasets used for the two use
    cases. These are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: The ECG dataset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The acne dataset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The ECG dataset
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following diagram presents a snapshot of the ECG dataset, which includes
    four classes of data. As shown in the diagram, each of the signals has distinctive
    features to be exploited by the DL models:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/72f757eb-be89-4f72-b8fe-0dbdf41b390d.png)'
  prefs: []
  type: TYPE_IMG
- en: We can generate this exploration result, or similar, using the available code, `ecg_singal_explorer.py`,
    in the chapter's `use-case-1` code folder.
  prefs: []
  type: TYPE_NORMAL
- en: The acne dataset
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We have used the acne and rosacea images dataset. The following screenshot
    presents a folder view of the dataset, including the number of images in the class.
    Unfortunately, as we can see, only four of the folders or classes have 100 or
    more images:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/cf6844f3-d4fb-4ce3-9e45-d4531507e121.png)'
  prefs: []
  type: TYPE_IMG
- en: As we are using MobileNet v1 architecture, any class with lower than 100 images
    might show an error. In fact, we have tested this and found the data size-related
    error. In this context, we have chosen a reduced dataset, which consists of only
    four classes of data that have more than 100 images.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the reduced acne dataset following exploration:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/757d1f52-3ca5-4292-96d3-1eea4d2de088.png)'
  prefs: []
  type: TYPE_IMG
- en: Data preprocessing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Data preprocessing is an essential step for a DL pipeline. The ECG dataset is
    not ready to be used for model training and validation. The preprocessor for the
    ECG signals is included in the model training and validation codes, `LSTM_ECG.py`
    and `CNN1D_ECG.py`, respectively. They will run the models after preprocessing
    `.mat` input data. However, the acne image dataset is ready to be used for training
    and validation.
  prefs: []
  type: TYPE_NORMAL
- en: Model training
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we mentioned earlier, we are using LSTM and CNN, particularly 1D CNN, for
    use case one. For use case two, we are using MobileNet v1\. All of these DL implementations
    support transfer learning that does not require training from scratch to use them
    in IoT devices.
  prefs: []
  type: TYPE_NORMAL
- en: Use case one
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We used an LSTM five-layered architecture for the ECG data classification,
    as shown in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1e65abf3-9627-4970-a5c0-88f92a6a457e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can train and test the model by running the `LSTM_ECG.py` file available
    in the chapter''s code folder named `use-case-1` subfolder:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'For the ECG data in the remote patient-management system, we also tested and
    validated a CNN model. The following diagram presents the CNN architecture we
    used for the ECG dataset. As we can see, the CNN architecture consists of four
    convolutional layers:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b5ecf62c-f78e-42b1-b04f-1e08218ab5a0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can train and test the model by running the `CNN1D_ECG.py` file, available
    in the chapter''s code folder named `use-case-1` subfolder:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Use case two
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We used MobileNet v1 for the second use case. The following diagram presents
    the architecture of the model:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/74b1bab5-469d-4085-ac21-37c1f7a3a64c.png)'
  prefs: []
  type: TYPE_IMG
- en: To train and validate the model on the acne dataset, we need to run the `retrain_CNN.py`
    file available in the chapter's code folder named `use-case-2` subfolder. To train
    and test the model*,* we need to just run the following in the Command Prompt.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The final two parameters of MobileNet v1 training are compulsory, and the rest
    are optional.
  prefs: []
  type: TYPE_NORMAL
- en: Model evaluations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We have evaluated three different aspects of the models:'
  prefs: []
  type: TYPE_NORMAL
- en: Learning/(re)training time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Storage requirement
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Performance (accuracy)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In terms of training time, in a desktop (Intel Xenon CPU E5-1650 v3 @3.5 GHz
    and 32 GB RAM) with GPU support, LSTM and CNN 1D on the ECG data took more than
    one hour, and MobileNet v1 on the acne dataset took less than 1 hour.
  prefs: []
  type: TYPE_NORMAL
- en: 'The storage requirement of a model is an essential consideration in resource-constrained
    IoT devices. The following screenshot presents the storage requirements for the
    three models we tested for the two use cases:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6c66eabf-5f6a-494a-96cc-cea9d8fc6127.png)'
  prefs: []
  type: TYPE_IMG
- en: As shown, a saved model of LSTM took 234 MB of storage, CNN 1D took 8.5 MB,
    and MobileNet v1 (CNN) took 16.3 MB. In terms of storage requirements, all of
    the models, except the current version of LSTM, are fine to be deployed in many
    resource-constrained IoT devices, including Raspberry Pi 3 or smartphones.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we have evaluated the performance of the models. In both of the use
    cases, dataset-wide evaluation or testing has been executed during the training
    phase in the desktop PC platform/server side, but we can also test them in the
    Raspberry Pi 3 or any IoT edge computing devices as the models are transferable.
  prefs: []
  type: TYPE_NORMAL
- en: Model performance (use case one)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following screenshot shows the training and validation result of the LSTM
    used on the ECG dataset. As seen in the screenshot, the test accuracy is consistently
    very close to 1.0 or 100%. However, validation accuracy is not great, and is in
    the range of 50% for the two different runs of the model (100 and 500 epochs).
    The following screenshot shows how the LSTM model is progressing during the training
    stage:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/75306c51-c5ca-4044-b569-8bf315bf0d76.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following graph, generated through TensorBoard''s log file, shows the training
    accuracy of the LSTM model on the ECG dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9ba98f59-9088-4c77-b24a-a560fc010c24.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following diagram presents the confusion matrix of the LSTM model''s validation
    results for the ECG data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e15b3019-2c21-4cfd-ae87-6404a50f6fac.png)'
  prefs: []
  type: TYPE_IMG
- en: The matrix clearly highlights the fact that the LSTM model is performing poorly
    on the ECG data. In particular, it is failing to identify most AF measurements
    (abnormal heart rhythm).
  prefs: []
  type: TYPE_NORMAL
- en: 'The LSTM''s poor performance on the ECG dataset motivated us to test the CNN
    1D model on the dataset. The following diagrams present the performance of the
    CNN 1D model on the ECG dataset. As shown in the diagrams, CNN''s one-dimensional
    model test accuracy is consistently well above 0.96 or 96% (slightly lower than
    for the LSTM model) and, importantly, its validation accuracies are consistently
    in the range of 0.82, which is well above that for LSTM. Models with this level
    of accuracy should be able to classify the correct heart rhythm of the patient
    in most cases and report accordingly. The following screenshot shows how the CNN
    1D model is progressing during the training stage and its final training and validation
    accuracy:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2110adc9-16e3-47df-a508-15e74bad8d23.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following graph, generated through TensorBoard''s log file, shows the validation
    accuracy of the CNN 1D model on the ECG dataset:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4fe89cfc-d2ce-4618-b92d-e2885a7333e3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following diagram presents the normalized confusion matrix of the CCN 1D
    model''s validation results for the ECG data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fd2e2af-4d10-417b-90d7-999bfcc8889b.png)'
  prefs: []
  type: TYPE_IMG
- en: The matrix clearly highlights the fact that the model is performing much better
    than the LSTM model on the ECG data. Importantly, it is successfully identifying
    most (87.5%) AF measurements (abnormal heart rhythm).
  prefs: []
  type: TYPE_NORMAL
- en: The CCN 1D model's performance can be improved; it can even be made very close
    to 100% by making the model's network denser. However, this will make the model
    complex, and the trained model will need more memory, making it unsuitable for
    resource-constrained IoT devices.
  prefs: []
  type: TYPE_NORMAL
- en: Model performance (use case two)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We have trained and validated the MobileNet v1 model on the reduced acne dataset.
    The following screenshot presents the evaluation results of the model. As we can
    see from the screenshot, training accuracy is 1.0, or 100% in most steps, and
    final test accuracy is 0.89, or 89%:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1c7c1c4c-11b4-4cd7-a0b4-557a507d38a7.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following graph, generated in TensorBoard using the model''s training and
    validation accuracies'' log files, show that training accuracies are a little
    inconsistent in the early steps, and consistently close to 1.0, or 100%, after
    that. On the other hand, validation accuracies are a little inconsistent in the
    range of 80-89%:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b812cbe8-3cdf-4a42-b62a-37e9f7d70bd4.png)'
  prefs: []
  type: TYPE_IMG
- en: We believe that, even with this inconsistency, the model should be able to detect
    the type of acne in more than 80% of cases.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The healthcare industry is adopting ML and DL for various applications. IoT
    healthcare applications need to adopt ML and DL techniques for the true realization
    of healthcare IoT. In this chapter, we have tried to show how DL-based IoT solutions
    can be useful and how they can be implemented in healthcare applications. In the
    first part of this chapter, we presented an overview of the various applications
    of IoT in healthcare. Then, we briefly discussed two use cases where healthcare
    services can be improved and/or automated through DL-supported IoT solutions.
    In the second part of the chapter, we presented a hands-on experience of the DL-based
    healthcare incident and/or skin diseases, detection part of the two use cases.
  prefs: []
  type: TYPE_NORMAL
- en: The use of DL in IoT applications is emerging. However, there are challenges
    associated with DL techniques and IoT that need to be addressed soon in order
    to get the best results from the integration of these two exciting technologies.
    In the next and final chapter, we will identify and discuss these challenges.
    In addition, we will provide a few future directions to mitigate some of the issues.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Bahar Farahani, Farshad Firouzi, Victor Chang, Mustafa Badaroglu, Nicholas
    Constant, and Kunal Mankodiya, *Towards fog-driven IoT eHealth: Promises and challenges
    of IoT in medicine and healthcare*, Future Generation Computer Systems, volume
    78, part 2, 2018, pages 659-676'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Missed GP appointments costing the NHS millions: [https://www.england.nhs.uk/2019/01/missed-gp-appointments-costing-nhs-millions/](https://www.england.nhs.uk/2019/01/missed-gp-appointments-costing-nhs-millions/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: World Health Organization, (September 10, 2017), *Noncommunicable diseases*: [http://www.who.int/mediacentre/factsheets/fs355/en/](http://www.who.int/mediacentre/factsheets/fs355/en/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'MACAELA MACKENZIE, *All the Ways Acne Can Mess With Your Mental Health*: [https://www.allure.com/story/how-acne-affects-mental-health-depression](https://www.allure.com/story/how-acne-affects-mental-health-depression)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Vallerand IA, Lewinson RT, Parsons LM, Lowerison MW, Frolkis AD, Kaplan GG,
    Barnabe C, Bulloch AGM, and Patten SB: *Risk of depression among patients with
    acne in the UK: a population-based cohort study*, Br. J. Dermatol, (2018) 178(3):
    e194-e195'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Riccardo Miotto, Fei Wang, Shuang Wang, Xiaoqian Jiang, and Joel T Dudley,
    *Deep learning for healthcare: review, opportunities, and challenges*, Briefings
    in Bioinformatics, Volume 19, Issue 6, November 2018, pp. 1236–1246'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PCh, Mark RG, Mietus
    JE, Moody GB, Peng C-K, Stanley HE. *PhysioBank, PhysioToolkit, and PhysioNet:
    components of a new research resource for complex physiologic signals*, *Circulation*
    (2000) 101(23): e215-e220'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'AliveCor: [https://www.alivecor.com/](https://www.alivecor.com/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Dermnet* *Skin Disease Atlas*: [http://www.dermnet.com/dermatology-pictures-skin-disease-pictures/](http://www.dermnet.com/dermatology-pictures-skin-disease-pictures/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
