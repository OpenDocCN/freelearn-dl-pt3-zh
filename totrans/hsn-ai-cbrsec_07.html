<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Network Anomaly Detection with AI</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">The current level of interconnection that can be established between different devices (for example, think of the </span><strong><span class="koboSpan" id="kobo.3.1">Internet of Things</span></strong><span class="koboSpan" id="kobo.4.1"> (</span><span><strong><span class="koboSpan" id="kobo.5.1">IoT</span></strong><span class="koboSpan" id="kobo.6.1">)</span></span><span class="koboSpan" id="kobo.7.1">) has reached such a complexity that it seriously questions the effectiveness of traditional concepts such as perimeter security. </span><span class="koboSpan" id="kobo.7.2">As a matter of fact, cyberspace's attack surface grows exponentially, and it is therefore essential to resort to automated tools for the effective detection of network anomalies associated with unprecedented cybersecurity threats.</span></p>
<p><span class="koboSpan" id="kobo.8.1">This chapter will cover the following topics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Network anomaly detection techniques</span></li>
<li><span class="koboSpan" id="kobo.10.1">How to classify network attacks</span></li>
<li><span class="koboSpan" id="kobo.11.1">Detecting botnet topology</span></li>
</ul>
<ul>
<li><span class="koboSpan" id="kobo.12.1">Different </span><strong><span class="koboSpan" id="kobo.13.1">machine learning</span></strong><span class="koboSpan" id="kobo.14.1"> (</span><strong><span class="koboSpan" id="kobo.15.1">ML</span></strong><span class="koboSpan" id="kobo.16.1">) algorithms for botnet detection</span></li>
</ul>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.17.1"> </span></p>
<p><span class="koboSpan" id="kobo.18.1">In this chapter, we will focus on anomaly detection related to network security, postponing the discussion of the aspects of fraud detection and user anomaly behavior detection until the following chapters.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Network anomaly detection techniques</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">The techniques we have seen so far can also be adopted to manage anomaly detection and related attempts to gain unauthorized access to the corporate network. </span><span class="koboSpan" id="kobo.2.2">To fully understand the potential of anomaly detection techniques, we will trace its evolution in the cybersecurity area, illustrating the basic principles that characterize it.</span></p>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.3.1">In fact, anomaly detection has always been a research area of cybersecurity, particularly in the field of network security protection. </span><span class="koboSpan" id="kobo.3.2">However, anomaly detection is not limited to identifying and preventing network attacks, but can also be adopted in other areas, such as fraud detection and in the identification of possible compromises of user profiles.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Anomaly detection rationales</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">In the area of ​​network intrusion detection in particular, the following two different approaches have been followed over time:</span></p>
<ul>
<li class="mce-root"><span><span class="koboSpan" id="kobo.3.1">Signature-based detection</span></span></li>
<li class="mce-root"><span class="koboSpan" id="kobo.4.1">Anomaly detection</span></li>
</ul>
<p><span class="koboSpan" id="kobo.5.1">In the first case, we start from the analysis of attacks that are already known, building a knowledge base of signatures of attacks that were previously detected. </span><span class="koboSpan" id="kobo.5.2">This gets combined with an alert system to be launched whenever a correspondence with archived signatures is detected in the network traffic. </span><span class="koboSpan" id="kobo.5.3">The analogies of signature-based detection systems with various antivirus software are obvious, and the disadvantages are equally evident, hence the knowledge base of the signatures must be constantly updated to detect new types of attacks.</span></p>
<p><span class="koboSpan" id="kobo.6.1">In the case of anomaly detection, on the other hand, an attempt is made to identify network traffic behavior that can be defined as </span><strong><span class="koboSpan" id="kobo.7.1">normal</span></strong><span class="koboSpan" id="kobo.8.1">, in order to detect differences in behavior that deviate from normality as </span><strong><span class="koboSpan" id="kobo.9.1">anomalous</span></strong><span class="koboSpan" id="kobo.10.1">. </span><span class="koboSpan" id="kobo.10.2">This approach, therefore, makes it possible to detect the new types of attack by analyzing the characteristics of network traffic that could be considered as anomalous.</span></p>
<p><span><span class="koboSpan" id="kobo.11.1">Therefore, i</span></span><span class="koboSpan" id="kobo.12.1">t will be necessary to identify what constitutes </span><strong><span class="koboSpan" id="kobo.13.1">abnormal behavior</span></strong><span class="koboSpan" id="kobo.14.1"> in terms of network traffic.</span></p>
<p><span><span class="koboSpan" id="kobo.15.1">In order to detect anomalous traffic, s</span></span><span class="koboSpan" id="kobo.16.1">ome elements that can be taken into consideration are as follows:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">The number of connections to and from a specific host</span></li>
<li><span class="koboSpan" id="kobo.18.1">Unusual remote communication ports or unexpected traffic patterns</span></li>
<li><span class="koboSpan" id="kobo.19.1">Unusual traffic peaks occurring at particular times of the day (for example, traffic carrying on during the night)</span></li>
<li><span class="koboSpan" id="kobo.20.1">Communication bandwidth heavily occupied by particular hosts within the network</span></li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.21.1">All these events may be considered as suspicious on the basis of the analysis previously conducted with respect to the network traffic that was regarded as normal. </span><span class="koboSpan" id="kobo.21.2">The basis of this comparison is that it is possible to define appropriate filters and associate alarm signals (alerts) with them, which, once triggered, can even determine the dropping of the corresponding network traffic.</span></p>
<p><span class="koboSpan" id="kobo.22.1">Obviously, it will also be necessary to take into account novelties in the network traffic that are not associated with suspicious behavior. </span><span class="koboSpan" id="kobo.22.2">If, for example, a new communication channel has been added that did not exist before, this change will have to be taken into account, and considered as normal.</span></p>
<p><span class="koboSpan" id="kobo.23.1">Therefore, one of the sensitive aspects of anomaly detection, as we will see, is the distinction between true positives and false positives.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Intrusion Detection Systems </span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">Traditionally, intrusion detection activity has been managed through the introduction of specialized devices, known as </span><strong><span class="koboSpan" id="kobo.3.1">Intrusion Detection Systems</span></strong><span class="koboSpan" id="kobo.4.1"> (</span><strong><span class="koboSpan" id="kobo.5.1">IDS</span></strong><span class="koboSpan" id="kobo.6.1">). </span><span class="koboSpan" id="kobo.6.2">These devices were usually divided into the following two categories:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">Host-based IDS</span></li>
<li><span class="koboSpan" id="kobo.8.1">Network-based IDS</span></li>
</ul>
<p><span class="koboSpan" id="kobo.9.1">With the introduction of </span><strong><span class="koboSpan" id="kobo.10.1">Artificial Intelligence</span></strong><span class="koboSpan" id="kobo.11.1"> (</span><strong><span class="koboSpan" id="kobo.12.1">AI</span></strong><span class="koboSpan" id="kobo.13.1">) techniques in the field of cybersecurity, a third type of IDS has also been added to the aforementioned two traditional types: anomaly-driven IDS.</span></p>
<p><span class="koboSpan" id="kobo.14.1">To fully understand the differences and advantages of anomaly-driven IDS, it is appropriate to briefly describe the two traditional types of IDS.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Host Intrusion Detection Systems</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">The task of </span><strong><span class="koboSpan" id="kobo.3.1">Host Intrusion Detection Systems</span></strong><span class="koboSpan" id="kobo.4.1"> (</span><strong><span class="koboSpan" id="kobo.5.1">HIDS</span></strong><span class="koboSpan" id="kobo.6.1">) is to detect possible intrusions affecting host machines within an organization, especially the machines that are considered critical. </span><span class="koboSpan" id="kobo.6.2">To this end, HIDS monitors some of the system metrics that are supposed to be significant for identifying possible attacks, such as system information associated with the following system metrics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">Number and type of running processes</span></li>
<li><span class="koboSpan" id="kobo.8.1">Number, type, and creation of user accounts</span></li>
<li><span class="koboSpan" id="kobo.9.1">Kernel modules loading (device drivers included)</span></li>
<li><span class="koboSpan" id="kobo.10.1">File and directory activity</span></li>
<li><span class="koboSpan" id="kobo.11.1">Task scheduler activity</span></li>
<li><span class="koboSpan" id="kobo.12.1">Registry key modification</span></li>
<li><span class="koboSpan" id="kobo.13.1">Background processes (daemons and services)</span></li>
<li><strong><span class="koboSpan" id="kobo.14.1">Operating system</span></strong><span class="koboSpan" id="kobo.15.1"> (</span><strong><span class="koboSpan" id="kobo.16.1">OS</span></strong><span class="koboSpan" id="kobo.17.1">) modules loaded at startup</span></li>
<li><span class="koboSpan" id="kobo.18.1">Host network activity</span></li>
</ul>
<p><span class="koboSpan" id="kobo.19.1">Typically, the identification of the system metrics to be monitored is strictly dependent on the adopted threat model, and in order to collect the information to be monitored, it is possible to use the tools that come installed with the OS of the host machines, or by installing specialized system monitoring tools.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Network Intrusion Detection Systems</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">The typical task of </span><strong><span class="koboSpan" id="kobo.3.1">Network Intrusion Detection Systems</span></strong><span class="koboSpan" id="kobo.4.1"> (</span><strong><span class="koboSpan" id="kobo.5.1">NIDS</span></strong><span class="koboSpan" id="kobo.6.1">) is to identify possible attack patterns by analyzing network traffic; that is, by processing network packets in transit</span><span><span class="koboSpan" id="kobo.7.1">—</span></span><span class="koboSpan" id="kobo.8.1">both incoming and outgoing</span><span><span class="koboSpan" id="kobo.9.1">—</span></span><span class="koboSpan" id="kobo.10.1">and detecting known attacking patterns in the flow of data.</span></p>
<p><span class="koboSpan" id="kobo.11.1">Some of the network attacks typically detected by NIDS are as follows:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.12.1">Adware (resulting in unsolicited and malicious </span><strong><span class="koboSpan" id="kobo.13.1">advertisements</span></strong><span class="koboSpan" id="kobo.14.1"> (</span><strong><span class="koboSpan" id="kobo.15.1">AD</span></strong><span class="koboSpan" id="kobo.16.1">) downloads from remote hosts)</span></li>
<li><span class="koboSpan" id="kobo.17.1">Spyware (sensitive information transmitted toward remote hosts)</span></li>
<li><strong><span class="koboSpan" id="kobo.18.1">Advanced Persistent Threats</span></strong><span class="koboSpan" id="kobo.19.1"> (</span><strong><span class="koboSpan" id="kobo.20.1">APTs</span></strong><span class="koboSpan" id="kobo.21.1">) (APT-targeted attacks that leverage specific organization flaws or misconfigured services)</span></li>
<li><span class="koboSpan" id="kobo.22.1">Botnets (a typical </span><strong><span class="koboSpan" id="kobo.23.1">Command and Control</span></strong><span class="koboSpan" id="kobo.24.1"> (</span><strong><span class="koboSpan" id="kobo.25.1">C2</span></strong><span class="koboSpan" id="kobo.26.1">) attack that leverages organization network resources by transforming hosts into zombie machines, executing remote instructions)</span></li>
</ul>
<p><span class="koboSpan" id="kobo.27.1">The implementation of NIDS can leverage network diagnostic tools including sniffers (such as </span><kbd><span class="koboSpan" id="kobo.28.1">tcpdump</span></kbd><span class="koboSpan" id="kobo.29.1"> and Wireshark).</span></p>
<p><span class="koboSpan" id="kobo.30.1">NIDS can also deploy integrated software solutions, such as Snort, which represents a valid solution for real-time detection of possible network intrusions.</span></p>
<p><span class="koboSpan" id="kobo.31.1">This helps to define ad hoc rules on the basis of which to make comparisons between normal and malicious network traffic, thus activating triggers that perform the appropriate actions once the attack is identified.</span></p>
<p><span class="koboSpan" id="kobo.32.1">Often, these triggers are associated with a given threshold, which is a predetermined value that reliably separates the events among them. </span><span class="koboSpan" id="kobo.32.2">Obviously, the problem of how to adequately determine this threshold value</span><span><span class="koboSpan" id="kobo.33.1"> arises</span></span><span class="koboSpan" id="kobo.34.1">, and whether this value can be validly used in relation to different contexts. </span><span class="koboSpan" id="kobo.34.2">In the same way, an attacker could try to modify this threshold value, or discover what this value actually is set to, try to adopt a stealth-access mode (by keeping their activity constantly below the threshold), and make themselves invisible to IDS.</span></p>
<p><span class="koboSpan" id="kobo.35.1">It would therefore be preferable to adopt a dynamic threshold (rather than relying on a hardcoded value) by systematically recalculating its value over time. </span><span class="koboSpan" id="kobo.35.2">These improvements can be obtained by resorting to statistical metrics, calculated on a time series (moving averages), for example, or through the re-elaboration of statistical measurements made on the distribution of the data (for example, adopting position measurements such as the median or the </span><strong><span class="koboSpan" id="kobo.36.1">interquartile range</span></strong><span class="koboSpan" id="kobo.37.1"> (</span><strong><span class="koboSpan" id="kobo.38.1">IQR</span></strong><span class="koboSpan" id="kobo.39.1">)).</span></p>
<p><span class="koboSpan" id="kobo.40.1">Although useful, this statistical approach for determining the trigger threshold is inevitably ineffective in the most complex cases of intrusion detection, which needs to take into account the possible correlations existing between the various variables.</span></p>
<p><span class="koboSpan" id="kobo.41.1">In other words, it is likely that in certain scenarios, the trigger thresholds to be triggered simultaneously are more than one, since the anomalies are represented by different features in relation to each other.</span></p>
<p><span class="koboSpan" id="kobo.42.1">Given the complexity that characterizes the network data flow, it is therefore necessary to introduce the </span><strong><span class="koboSpan" id="kobo.43.1">stateful inspection</span></strong><span class="koboSpan" id="kobo.44.1">—also known as </span><strong><span class="koboSpan" id="kobo.45.1">Packet Filtering</span></strong><span class="koboSpan" id="kobo.46.1"> activity—as separate from the common network monitoring (aimed at extracting information from different types of packets).</span></p>
<p><span class="koboSpan" id="kobo.47.1">By keeping track of the various packets being transferred and received, the stateful inspection is characterized by the ability to correlate different types of packets in order to identify connection attempts toward certain network services, attempts to saturate network resources (</span><strong><span class="koboSpan" id="kobo.48.1">Denial of Service</span></strong><span class="koboSpan" id="kobo.49.1"> (</span><strong><span class="koboSpan" id="kobo.50.1">DoS</span></strong><span class="koboSpan" id="kobo.51.1">)), or attacks conducted at the lower network protocol levels (such as ARP cache poisoning).</span></p>
<p><span class="koboSpan" id="kobo.52.1">Given its advanced network analysis features, stateful inspection can be associated with more sophisticated forms of anomaly detection.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Anomaly-driven IDS</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">With the introduction of AI techniques to the field of NIDS, it is now possible to evolve traditional IDS toward more advanced detection solutions, exploiting supervised and unsupervised learning algorithms, as well as reinforcement learning and deep learning.</span></p>
<p><span class="koboSpan" id="kobo.3.1">Similarly, the clustering techniques analyzed in the previous chapters, which exploit the concepts of similarity between the categories of data, can validly </span><span><span class="koboSpan" id="kobo.4.1">be </span></span><span class="koboSpan" id="kobo.5.1">used for the implementation of anomaly-based IDS.</span></p>
<p><span class="koboSpan" id="kobo.6.1">In choosing the algorithms for the anomaly detection network, however, some characteristic aspects of the network environment must be taken into consideration:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">In the case of solutions based on supervised learning algorithms, we will have to categorize (label) all the data since, by definition, in supervised learning the classes to which sample data belongs are known in advance.</span></li>
<li><span class="koboSpan" id="kobo.8.1">The categorization of all the data inevitably involves a computational overload and a possible slowdown in the network performance, since the network traffic must be analyzed before being sent to the destination. </span><span class="koboSpan" id="kobo.8.2">In this sense, we could decide to resort to unsupervised learning algorithms, not only to let the algorithm identify unknown classes, but also to reduce the computational overhead.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.9.1">Similarly, the algorithms that exploit the concept of similarity (such as clustering algorithms) are well suited for the implementation of anomaly detection solutions. </span><span class="koboSpan" id="kobo.9.2">However, it is also necessary in this case to pay particular attention to the type of metrics used to define the concept of similarity that distinguishes the traffic considered as normal from that being considered as anomalous.</span></p>
<p><span class="koboSpan" id="kobo.10.1">Commonly, in the implementation of anomaly detection solutions, scoring systems are used for the assessment of traffic: identifying thresholds of values ​​that separate the different types of traffic from each other (normal versus anomalous). </span><span class="koboSpan" id="kobo.10.2">For this purpose, when choosing the most appropriate metrics, we must take into consideration the ordering and distribution of the data.</span></p>
<p><span class="koboSpan" id="kobo.11.1">In other words, an anomaly detection system can use—as a scoring metric—the distance existing between the values ​​of the dataset (considered as points of the </span><em><span class="koboSpan" id="kobo.12.1">n</span></em><span class="koboSpan" id="kobo.13.1">-dimensional space representing the different features), or evaluate the regularity in the distribution of data, with respect to a distribution considered representative of the phenomenon under investigation.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Turning service logs into datasets</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">One of the problems related to network anomaly detection is how to collect sufficient and reliable data to perform algorithm analysis and training. </span><span class="koboSpan" id="kobo.2.2">There are hundreds of datasets freely available on the internet, and there are different datasets on which to carry out our analysis; however, it is also possible to use our own network devices to accumulate data that is more representative of our specific reality.</span></p>
<p><span class="koboSpan" id="kobo.3.1">To this end, we can use the following:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.4.1">Network devices, such as routers or network sensors, using tools such as </span><kbd><span class="koboSpan" id="kobo.5.1">tcpdump</span></kbd><span class="koboSpan" id="kobo.6.1"> for data collection</span></li>
<li><span class="koboSpan" id="kobo.7.1">Services logs and system logs</span></li>
</ul>
<p><span class="koboSpan" id="kobo.8.1">Within the operating system, services logs and system logs can be stored in various places. </span><span class="koboSpan" id="kobo.8.2">In the case of a Unix-like system, the services logs are usually stored as text files inside the </span><kbd><span class="koboSpan" id="kobo.9.1">/var/log</span></kbd><span class="koboSpan" id="kobo.10.1"> directory and its relative subdirectories. </span><span class="koboSpan" id="kobo.10.2">In the case of Windows OSes, logs are distinguished between Windows logs (including security logs and system logs) and application logs. </span><span class="koboSpan" id="kobo.10.3">They are accessible through the Windows Event Viewer application, or by accessing file system locations such as </span><kbd><span class="koboSpan" id="kobo.11.1">%SystemRoot%\System32\Config</span></kbd><span class="koboSpan" id="kobo.12.1">.</span></p>
<p><span class="koboSpan" id="kobo.13.1">In both the cases of Unix-like systems and Windows OSes, the log files are of a text-based format according to predefined templates, with the difference being that, in the case of Windows, an event ID is also associated with each event recorded in the corresponding log file. </span><span class="koboSpan" id="kobo.13.2">The textual nature of the logs files is well suited for the integration of the information stored in the logs.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Advantages of integrating network data with service logs</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">Both data sources, that is, network data and services logs, entail advantages and disadvantages for the purposes of network anomaly detection.</span></p>
<p><span class="koboSpan" id="kobo.3.1">However, their integration makes it possible to limit the disadvantages in favor of the advantages.</span></p>
<p><span class="koboSpan" id="kobo.4.1">It is no coincidence that in recent years, several software solutions (both proprietary and open source) have been released to solve the task of integrating different data sources, allowing users to utilize methods of analysis from data science and big data analytics.</span></p>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.5.1">Among the most widespread solutions, we can mention the </span><strong><span class="koboSpan" id="kobo.6.1">ElasticSearch, Logstash, Kibana</span></strong><span class="koboSpan" id="kobo.7.1"> (</span><strong><span class="koboSpan" id="kobo.8.1">ELK</span></strong><span class="koboSpan" id="kobo.9.1">) suite, which allows the indexing of events extracted from log files and can be represented in an intuitive visual form.</span></p>
<p><span class="koboSpan" id="kobo.10.1">Other widespread proprietary networking solutions are based on Cisco's NetFlow protocol, which allows for a compact representation of network traffic.</span></p>
<p><span class="koboSpan" id="kobo.11.1">Reconstructing the events of interest starting from the raw data is anything but easy. </span><span class="koboSpan" id="kobo.11.2">This moreover lends itself—if carried out in an automated manner—to the generation of unreliable signals (false positives) that represent a problem in the management of security.</span></p>
<p><span class="koboSpan" id="kobo.12.1">Moreover, in the case of network data, they are representative of the individual services to which they refer, while in the case of service logs, they are directly related to the processes that generated them.</span></p>
<p><span class="koboSpan" id="kobo.13.1">The integration of both data sources (network data and service logs) therefore allows for a contextualization of the events being analyzed, consequently increasing contextual awareness, and reducing the effort required for interpreting events when starting from raw data.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">How to classify network attacks</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">We have seen that it is possible to use all different types of algorithms (such as supervised, unsupervised, and reinforcement learning), even in the implementation of network anomaly detection systems.</span></p>
<p><span class="koboSpan" id="kobo.3.1">But how can we effectively train these algorithms in order to identify the anomalous traffic?</span></p>
<p><span class="koboSpan" id="kobo.4.1">It will be necessary to first identify a training dataset that is representative of the traffic considered normal within a given organization.</span></p>
<p><span class="koboSpan" id="kobo.5.1">To this end, we will have to adequately choose the representative features of our model.</span></p>
<p><span class="koboSpan" id="kobo.6.1">The choice of features is of particular importance, as they provide a contextual value to the analyzed data, and consequently determine the reliability and accuracy of our detection system.</span></p>
<p><span class="koboSpan" id="kobo.7.1">In fact, choosing features that are not characterized by high correlation with possible anomalous behaviors translates into high error rates (false positives), which therefore invalidate their usefulness.</span></p>
<p><span class="koboSpan" id="kobo.8.1">A solution to choosing reliable features could be to evaluate existing anomalies in the use of network protocols.</span></p>
<p><span class="koboSpan" id="kobo.9.1">Attacks—such as SYN floods—are characterized by the anomalous use of the TCP/IP handshake (in which the packet with the SYN flag set is not followed by packets with the ACK flag set, in order to establish a valid connection).</span></p>
<p><span class="koboSpan" id="kobo.10.1">A feature can be characterized by one or more attributes related to the protocol or the header of the network packet, just as different types of network attributes constitute a feature represented by the specific network connection being analyzed (that is, a telnet session is characterized by a connection to a remote port </span><kbd><span class="koboSpan" id="kobo.11.1">23</span></kbd><span class="koboSpan" id="kobo.12.1">, which is carried out between two endpoints having their respective IP addresses and IP ports).</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Most common network attacks</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">Given the enormous variety of combinations that we can identify by putting together different features, it is inevitable that we have to resort to a threat model that reflects the level of risk to which a given organization is subjected, and on the basis of this model, to identify the most representative feature of combinations for possible attacks.</span></p>
<p><span class="koboSpan" id="kobo.3.1">In this sense, it can be useful to analyze which are the most frequent types of network attacks:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.4.1">Malware-based</span></li>
<li><span class="koboSpan" id="kobo.5.1">Zero-day exploits</span></li>
<li><span class="koboSpan" id="kobo.6.1">Data exfiltration via network sniffing</span></li>
<li><span class="koboSpan" id="kobo.7.1">Saturation of network resources (DoS)</span></li>
<li><span class="koboSpan" id="kobo.8.1">Session hijacking</span></li>
<li><span class="koboSpan" id="kobo.9.1">Connection spoofing</span></li>
<li><span class="koboSpan" id="kobo.10.1">Port scanning</span></li>
</ul>
<p><span class="koboSpan" id="kobo.11.1">On the basis of a similar classification (to be adapted to the specific context and constantly updated), we can identify which features to consider, feeding our algorithms with more representative datasets.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Anomaly detection strategies</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">We have therefore seen that the very concept of anomaly detection refers to a behavior that is different from what was expected; this difference, in technical terms, translates into outlier detection.</span></p>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.3.1">To identify the outliers, it is possible to follow different strategies:</span></p>
<ul>
<li>
<p><strong><span class="koboSpan" id="kobo.4.1">Analyzing a sequence of events within a time series</span></strong><span class="koboSpan" id="kobo.5.1">: The data is collected at regular intervals, evaluating the changes that occur in the series over time. </span><span class="koboSpan" id="kobo.5.2">This is a technique widely used in the analysis of financial markets, but it can be also validly used in the cybersecurity context to detect the frequency of characters (or commands) entered by the user in a remote session. </span><span class="koboSpan" id="kobo.5.3">Even the simple unnatural increase in the frequency of data entered per unit of time is indicative of an anomaly that can be traced back to the presence of an automated agent (instead of a human user) in the remote endpoint.</span></p>
</li>
<li>
<p><strong><span class="koboSpan" id="kobo.6.1">Using supervised learning algorithms</span></strong><span class="koboSpan" id="kobo.7.1">: This approach makes sense when normal and anomalous behaviors can be reliably distinguished from each other, as in the case of credit card fraud, in which it is possible to detect predefined patterns of suspicious behavior, relying on the fact that future fraud attempts are attributable to a predefined scheme.</span></p>
</li>
<li>
<p><strong><span class="koboSpan" id="kobo.8.1">Using unsupervised learning algorithms</span></strong><span class="koboSpan" id="kobo.9.1">: In this case, it is not possible to trace the anomalies back to predefined behaviors, as it is not possible to identify a reliable and representative training dataset for supervised learning. </span><span class="koboSpan" id="kobo.9.2">This scenario is the one that most commonly describes the reality of cybersecurity, characterized by new forms of attack or exploits of new vulnerabilities (zero-day attacks). </span><span class="koboSpan" id="kobo.9.3">Similarly, it is often difficult to trace all the theoretically possible intrusions back to a single predefined scheme.</span></p>
</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Anomaly detection assumptions and challenges</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">From a methodological point of view, there is no doubt that outliers represent a problem for learning algorithms, as they constitute a disturbing element in the identification of a descriptive model, starting from training data.</span></p>
<p><span class="koboSpan" id="kobo.3.1">When dealing with an anomalous value, how should the algorithm behave? </span><span class="koboSpan" id="kobo.3.2">Should it take into account the determination of the model or should it discard it, considering it as an estimation error? </span><span class="koboSpan" id="kobo.3.3">Or do the outliers represent novelties in the dataset that testify to real changes in the phenomenon being under scrutiny? </span><span class="koboSpan" id="kobo.3.4">To answer these questions, we need to investigate the most probable origin of the outliers.</span></p>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.4.1">In some cases, the outliers are a combination of uncommon values, they are estimate errors, or they originate from the joining of multiple datasets with different semantics that produce unreliable or highly unlikely samples. </span><span class="koboSpan" id="kobo.4.2">Their presence, however, represents a disturbing element, especially for the algorithms that are based on metrics consisting of estimating the distances between expected values ​​and observed values. </span><span class="koboSpan" id="kobo.4.3">In technical terms, this implies an increase in overall variance that can cause the algorithm to overestimate the error to the detriment of the signal (a well-known phenomenon that goes by the name of </span><strong><span class="koboSpan" id="kobo.5.1">overfitting</span></strong><span class="koboSpan" id="kobo.6.1">).</span></p>
<p><span class="koboSpan" id="kobo.7.1">Obviously, not all algorithms are equally sensitive to the presence of outliers. </span><span class="koboSpan" id="kobo.7.2">However, it is good practice to try to make the learning process robust, smoothing the parameter-updating phase, weighting those anomalous values that, even if lower in numerical terms with respect to normal values, might otherwise affect the correct parameters estimation.</span></p>
<p><span class="koboSpan" id="kobo.8.1">To identify the possible presence of outliers within the dataset, it is good practice to conduct a preliminary analysis of the data, known as </span><strong><span class="koboSpan" id="kobo.9.1">exploratory data analysis</span></strong><span class="koboSpan" id="kobo.10.1"> (</span><strong><span class="koboSpan" id="kobo.11.1">EDA</span></strong><span class="koboSpan" id="kobo.12.1">), using visual tools and calculating simple descriptive statistical measurements (such as the average or the median).</span></p>
<p><span class="koboSpan" id="kobo.13.1">In this way, it is possible to intuitively spot the presence of anomalous values, in addition to verifying any asymmetries in the data, evidenced by the increasing distance between the values ​​of the average and the median in the distribution.</span></p>
<p><span class="koboSpan" id="kobo.14.1">Some statistical measurements are less sensitive to the presence of extreme values. </span><span class="koboSpan" id="kobo.14.2">The measures aimed at representing the ordering of the data are, in fact, more robust with respect to the presence of anomalous values ​​in the distribution (such as the IQRs).</span></p>
<p><span><span class="koboSpan" id="kobo.15.1">Therefore, o</span></span><span class="koboSpan" id="kobo.16.1">ne of the fundamental assumptions in outlier detection is that there are many more normal observations within a dataset with respect to anomalous observations. </span><span class="koboSpan" id="kobo.16.2">However, the fact remains that, often, the correct identification of the outliers is not an easy task to accomplish.</span></p>
<p><span class="koboSpan" id="kobo.17.1">In this sense, if we decide to use statistical measures to determine the presence of the outliers, we can proceed with the following steps:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.18.1">Calculate statistical values ​​representative of the data to be used as comparison terms to determine the anomalous values ​​(that is, the values ​​that deviate from the representative ones the</span><span><span class="koboSpan" id="kobo.19.1"> most</span></span><span class="koboSpan" id="kobo.20.1">)</span></li>
<li><span class="koboSpan" id="kobo.21.1">Identify a reference model for anomaly detection, which can be based on distance measurements, or assume a known </span><strong><span class="koboSpan" id="kobo.22.1">statistical distribution</span></strong><span class="koboSpan" id="kobo.23.1"> (that is, a normal distribution) as representative of normal values</span></li>
<li><span class="koboSpan" id="kobo.24.1">Define a confidence interval and evaluate the probability (likelihood) of outlier's presence, given a chosen distribution</span></li>
</ol>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.25.1">The statistical approach to the identification of outliers, while being easy and immediate to apply, nevertheless presents important methodological limits:</span></p>
<ul>
<li class="mce-root"><span><span class="koboSpan" id="kobo.26.1">Most of the statistical tests take into account only single features</span></span></li>
<li class="mce-root"><span class="koboSpan" id="kobo.27.1">Often, the underlying distribution of the data is unknown, or not attributable to a known statistical distribution</span><br/></li>
<li class="mce-root"><span class="koboSpan" id="kobo.28.1">In the presence of complex and multi dimensional cases (in which several features must be taken into account simultaneously), the presence of outliers determines an increase in the total variance, making the </span><span><span class="koboSpan" id="kobo.29.1">identified </span></span><span><span class="koboSpan" id="kobo.30.1">representative models less significant in predictive terms</span></span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Detecting botnet topology</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">One of the most common pitfalls in network anomaly detection has to do with the detection of botnets within the corporate network. </span><span class="koboSpan" id="kobo.2.2">G</span><span><span class="koboSpan" id="kobo.3.1">iven the danger of such hidden networks, t</span></span><span class="koboSpan" id="kobo.4.1">he detection of botnets is particularly relevant, not only for preventing the exhaustion of the organization's computational and network resources by external attackers, but also for preventing the dissemination of sensitive information (data leakage) outward.</span></p>
<p><span class="koboSpan" id="kobo.5.1">However, identifying the presence of a botnet in time is often an operation that is anything but simple. </span><span class="koboSpan" id="kobo.5.2">This is why it is important to understand the very nature of botnets.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">What is a botnet?</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">The term </span><strong><span class="koboSpan" id="kobo.3.1">botnet</span></strong><span class="koboSpan" id="kobo.4.1"> comes from the juxtaposition of the words </span><strong><span class="koboSpan" id="kobo.5.1">bot</span></strong><span class="koboSpan" id="kobo.6.1"> and </span><strong><span class="koboSpan" id="kobo.7.1">net</span></strong><span class="koboSpan" id="kobo.8.1">. </span><span class="koboSpan" id="kobo.8.2">In the case of the term </span><strong><span class="koboSpan" id="kobo.9.1">net</span></strong><span class="koboSpan" id="kobo.10.1">, we evidently have to deal with the concept of networking; in the case of the term </span><strong><span class="koboSpan" id="kobo.11.1">bot</span></strong><span class="koboSpan" id="kobo.12.1">, we have to spend a few more words.</span></p>
<p><span class="koboSpan" id="kobo.13.1">The term bot is, in fact, increasingly associated with the spread of automated agents within cyberspace.</span></p>
<p><span class="koboSpan" id="kobo.14.1">Starting from </span><strong><span class="koboSpan" id="kobo.15.1">chatbots</span></strong><span class="koboSpan" id="kobo.16.1"> (software agents that are commonly present in websites for the management of the preliminary phases of customer care, but are also increasingly widespread, even on the social networks for the most disparate purposes) all the way to trolls (software agents aimed at distracting users or confusing them with the dissemination of false information), cyberspace is increasingly becoming infested with the presence of such software agents that automate the activities and interactions between humans and digital devices.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p><span class="koboSpan" id="kobo.17.1">In the case of botnets, the attacker's intent is to transform the victim host (by installing malware) into an automated agent that fulfills the orders received by the attacker, through a C2 console that is usually managed by a centralized server.</span></p>
<p><span class="koboSpan" id="kobo.18.1">The victim machine thus becomes part of a vast network of compromised machines (the botnet), </span><span><span class="koboSpan" id="kobo.19.1">contributing </span></span><span><span class="koboSpan" id="kobo.20.1">toward a common goal </span></span><span><span class="koboSpan" id="kobo.21.1">with its own computational and network resources</span></span><span class="koboSpan" id="kobo.22.1">:</span></p>
<ul>
<li class="CDPAlignLeft CDPAlign"><span class="koboSpan" id="kobo.23.1">Taking part in email spamming campaigns</span></li>
<li><span class="koboSpan" id="kobo.24.1">Performing </span><strong><span class="koboSpan" id="kobo.25.1">Distributed Denial of Services</span></strong><span class="koboSpan" id="kobo.26.1"> (</span><strong><span class="koboSpan" id="kobo.27.1">DDoS</span></strong><span class="koboSpan" id="kobo.28.1">) toward institutional or private third-party sites</span></li>
<li><span class="koboSpan" id="kobo.29.1">Bitcoin and cryptocurrency mining</span></li>
<li><span class="koboSpan" id="kobo.30.1">Password cracking</span></li>
<li><span class="koboSpan" id="kobo.31.1">Credit card cracking</span></li>
<li><span class="koboSpan" id="kobo.32.1">Data leakages and data breaches</span></li>
</ul>
<p><span class="koboSpan" id="kobo.33.1">For an organization, dealing with a botnet (even unconsciously) represents a serious risk in terms of legal responsibility toward third parties; it is not just a waste of company resources.</span></p>
<p><span class="koboSpan" id="kobo.34.1">This is why it is important to monitor the company network by trying to promptly identify the presence of hosts that might be part of a botnet.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">The botnet kill chain</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">In order to promptly identify the possible presence of a botnet, it may be useful to consider its kill chain (the different phases that characterize its realization).</span></p>
<p><span class="koboSpan" id="kobo.3.1">We can, therefore, distinguish the following phases:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.4.1">Malicious software installation</span></li>
<li><span class="koboSpan" id="kobo.5.1">Joining the botnet via C2</span></li>
<li><span class="koboSpan" id="kobo.6.1">Spreading the botnet to other hosts</span></li>
</ul>
<p><span class="koboSpan" id="kobo.7.1">Among the events to constantly monitor for the possible presence of a botnet, the connections made at regular intervals to remote hosts should be included. </span><span class="koboSpan" id="kobo.7.2">Rather than monitoring the quality of the traffic itself (very often, in fact, botnets make use of apparently harmless communication protocols, such as HTTP traffic, using the service's default port </span><kbd><span class="koboSpan" id="kobo.8.1">80</span></kbd><span class="koboSpan" id="kobo.9.1">, in order to mask its presence within the logs files), the real nature of network connections should be investigated.</span></p>
<p><span class="koboSpan" id="kobo.10.1">In the case of a botnet, the victim host must constantly call home to receive new orders and send the information gathered</span><span><span class="koboSpan" id="kobo.11.1"> to the C2 server</span></span><span class="koboSpan" id="kobo.12.1">, along with the results obtained from the processes that were performed on the victim system.</span></p>
<p><span class="koboSpan" id="kobo.13.1">This phenomenon is known as </span><strong><span class="koboSpan" id="kobo.14.1">beaconing</span></strong><span class="koboSpan" id="kobo.15.1"> and is characterized precisely by the presence within the network of connections made on a regular basis (even during closing hours) between infected hosts and remote destinations (which can also be legitimate websites compromised by the attacker).</span></p>
<p><span class="koboSpan" id="kobo.16.1">The phenomenon of beaconing is usually characterized by the presence of the following characteristics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">Long-term user sessions, with the exchange of empty packages (keepalive packets) necessary to keep the connection open</span></li>
<li><span class="koboSpan" id="kobo.18.1">Data exchange between hosts on a regular basis</span></li>
</ul>
<p><span class="koboSpan" id="kobo.19.1">The problem with beaconing is that it cannot always be identified reliably; thus, they constitute a symptom of the presence of a botnet, as other legitimate services also show characteristics similar to those mentioned previously. </span><span class="koboSpan" id="kobo.19.2">To capture the reliable signals that attest the presence of a real beaconing process—telling it apart from a benign SSH or telnet session, as well as from the systematic download of updates carried out by an antivirus software—therefore requires in-depth network traffic monitoring, along with statistical analysis of a time series and calculating position measures such as the median and IQR, in order to spot communications that are taking place on a regular basis.</span></p>
<p><span class="koboSpan" id="kobo.20.1">Subsequently, it is necessary to graphically visualize the mapping of the local and remote hosts that present these connections, in order to identify a possible network topology with stable characteristics that can reasonably raise suspects of the presence of a botnet.</span></p>
<p><span class="koboSpan" id="kobo.21.1">From this description of the necessary preliminary analysis activities, it is easy to deduce how high the risk is of ending up trapped in a network of false positives, rather than in a real botnet, especially if the number of potential appliances that are constantly connected to the network increases exponentially (a scenario that is progressively becoming more realistic than ever before, due to the spread of the IoT).</span></p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Different ML algorithms for botnet detection</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">From what we have described so far, it is clear that it is not advisable to exclusively rely on automated tools for network anomaly detection, but it may be more productive to adopt AI algorithms that are able to dynamically learn how to recognize the presence of any anomalies within the network traffic, thus allowing the analyst to perform an in-depth analysis of only really suspicious cases. </span><span class="koboSpan" id="kobo.2.2">Now, we will demonstrate the use of different ML algorithms for network anomaly detection, which can also be used to identify a botnet.</span></p>
<p><span class="koboSpan" id="kobo.3.1">The selected features in our example consist of the values of network latency and network throughput. </span><span class="koboSpan" id="kobo.3.2">In our threat model, anomalous values ​​associated with these features can be considered as representative of the presence of a botnet.</span></p>
<p><span class="koboSpan" id="kobo.4.1">For each example, the accuracy of the algorithm is calculated, in order to be able to make comparisons between the results obtained:</span></p>
<pre><span class="koboSpan" id="kobo.5.1">import numpy as np</span><br/><span class="koboSpan" id="kobo.6.1">import pandas as pd</span><br/><br/><span class="koboSpan" id="kobo.7.1">from sklearn.linear_model import *</span><br/><span class="koboSpan" id="kobo.8.1">from sklearn.tree import *</span><br/><span class="koboSpan" id="kobo.9.1">from sklearn.naive_bayes import *</span><br/><span class="koboSpan" id="kobo.10.1">from sklearn.neighbors import *</span><br/><span class="koboSpan" id="kobo.11.1">from sklearn.metrics import accuracy_score</span><br/><br/><span class="koboSpan" id="kobo.12.1">from sklearn.model_selection import train_test_split</span><br/><br/><span class="koboSpan" id="kobo.13.1">import matplotlib.pyplot as plt</span><br/><span class="koboSpan" id="kobo.14.1">%matplotlib inline</span><br/><br/><span class="koboSpan" id="kobo.15.1"># Load the data</span><br/><span class="koboSpan" id="kobo.16.1">dataset = pd.read_csv('../datasets/network-logs.csv')</span><br/><br/><span class="koboSpan" id="kobo.17.1">samples = dataset.iloc[:, [1, 2]].values</span><br/><span class="koboSpan" id="kobo.18.1">targets = dataset['ANOMALY'].values
</span><br/><span class="koboSpan" id="kobo.19.1">training_samples, testing_samples, training_targets, testing_targets =</span><br/><span class="koboSpan" id="kobo.20.1">train_test_split(samples, targets, test_size=0.3, random_state=0)</span><br/><br/><br/><span class="koboSpan" id="kobo.21.1"># k-Nearest Neighbors model</span><br/><span class="koboSpan" id="kobo.22.1">knc = KNeighborsClassifier(n_neighbors=2)</span><br/><span class="koboSpan" id="kobo.23.1">knc.fit(training_samples,training_targets)</span><br/><span class="koboSpan" id="kobo.24.1">knc_prediction = knc.predict(testing_samples)</span><br/><span class="koboSpan" id="kobo.25.1">knc_accuracy = 100.0 * accuracy_score(testing_targets, knc_prediction)</span><br/><span class="koboSpan" id="kobo.26.1">print ("K-Nearest Neighbours accuracy: " + str(knc_accuracy))</span><br/><br/><span class="koboSpan" id="kobo.27.1">K-Nearest Neighbours accuracy: 95.90163934426229</span><br/><br/><span class="koboSpan" id="kobo.28.1"># Decision tree model</span><br/><span class="koboSpan" id="kobo.29.1">dtc = DecisionTreeClassifier(random_state=0)</span><br/><span class="koboSpan" id="kobo.30.1">dtc.fit(training_samples,training_targets)</span><br/><span class="koboSpan" id="kobo.31.1">dtc_prediction = dtc.predict(testing_samples)</span><br/><span class="koboSpan" id="kobo.32.1">dtc_accuracy = 100.0 * accuracy_score(testing_targets, dtc_prediction)</span><br/><span class="koboSpan" id="kobo.33.1">print ("Decision Tree accuracy: " + str(dtc_accuracy))</span><br/><br/><span class="koboSpan" id="kobo.34.1">Decision Tree accuracy: 96.72131147540983</span><br/><br/><br/><span class="koboSpan" id="kobo.35.1"># Gaussian Naive Bayes model</span><br/><span class="koboSpan" id="kobo.36.1">gnb = GaussianNB()</span><br/><span class="koboSpan" id="kobo.37.1">gnb.fit(training_samples,training_targets)</span><br/><span class="koboSpan" id="kobo.38.1">gnb_prediction = gnb.predict(testing_samples)</span><br/><span class="koboSpan" id="kobo.39.1">gnb_accuracy = 100.0 * accuracy_score(testing_targets, gnb_prediction)</span><br/><span class="koboSpan" id="kobo.40.1">print ("Gaussian Naive Bayes accuracy: " + str(gnb_accuracy))</span><br/><br/><span class="koboSpan" id="kobo.41.1">Gaussian Naive Bayes accuracy: 98.36065573770492</span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Gaussian anomaly detection</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">One of the most widespread approaches for detecting regularity within data distribution makes use of the Gaussian distribution of probabilities.</span></p>
<p><span class="koboSpan" id="kobo.3.1">As we shall see, this statistical distribution presents a series of interesting characteristics that help to adequately model many natural, social, and economic phenomena.</span></p>
<p><span class="koboSpan" id="kobo.4.1">Obviously, not all the phenomena under investigation can be represented by the Gaussian distribution (very often, as we have seen, the underlying distribution of the analyzed phenomena is unknown); however, it constitutes a reliable reference point in many cases of anomaly detection.</span></p>
<p><span class="koboSpan" id="kobo.5.1">Therefore, we must see the characteristics of the Gaussian distribution in order to understand why it is frequently used.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">The Gaussian distribution</span></h1>
                </header>
            
            <article>
                
<p><span><span class="koboSpan" id="kobo.2.1">In mathematical terms, the Gaussian distribution (also known as the </span><strong><span class="koboSpan" id="kobo.3.1">normal distribution</span></strong><span class="koboSpan" id="kobo.4.1">) represents a probability distribution of random variables, which takes the following mathematical form:</span></span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.5.1"><img class="fm-editor-equation" src="assets/855e4324-2b8a-43bb-a832-38021286110a.png" style="width:21.17em;height:4.58em;"/></span></p>
<p><span class="koboSpan" id="kobo.6.1">Here, </span><em><span class="koboSpan" id="kobo.7.1">µ</span></em><span class="koboSpan" id="kobo.8.1"> represents the average, and </span><em><span class="koboSpan" id="kobo.9.1">σ</span><sup><span class="koboSpan" id="kobo.10.1">2</span></sup></em><span class="koboSpan" id="kobo.11.1"> is the variance (which is representative of the variability of the data around the average value). </span><span class="koboSpan" id="kobo.11.2">In its standard form, the mean, </span><em><span class="koboSpan" id="kobo.12.1">µ</span></em><span class="koboSpan" id="kobo.13.1">, assumes the value of </span><em><span class="koboSpan" id="kobo.14.1">0</span></em><span class="koboSpan" id="kobo.15.1">, and </span><em><span class="koboSpan" id="kobo.16.1">σ</span></em><sup><em><span class="koboSpan" id="kobo.17.1">2</span></em></sup><span class="koboSpan" id="kobo.18.1"> assumes the value of </span><em><span class="koboSpan" id="kobo.19.1">1</span></em><span class="koboSpan" id="kobo.20.1">.</span></p>
<p><span class="koboSpan" id="kobo.21.1">The strength of the Gaussian distribution is the central limit theorem, which, in general terms, establishes that the average of the observational data of a random variable—extracted independently—converges to the normal value as the number of observations increases.</span></p>
<p><span class="koboSpan" id="kobo.22.1">In other words, the observations, as their number increases, are distributed symmetrically (and with greater probability) around the mean, </span><em><span class="koboSpan" id="kobo.23.1">µ</span></em><span class="koboSpan" id="kobo.24.1">:</span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.25.1"><img src="assets/d85c75c0-4d94-4314-bcb5-52500391417b.png" style="width:34.58em;height:22.08em;"/></span></p>
<p><span class="koboSpan" id="kobo.26.1">While they deviate from the average value (tending to be distributed in the left and right extremities) for increasing values of </span><em><span class="koboSpan" id="kobo.27.1">σ</span></em><span class="koboSpan" id="kobo.28.1">, the normal distribution is therefore adequately represented by the values assumed by </span><em><span class="koboSpan" id="kobo.29.1">µ</span></em><span class="koboSpan" id="kobo.30.1"> and </span><em><span class="koboSpan" id="kobo.31.1">σ</span></em><span class="koboSpan" id="kobo.32.1">.</span></p>
<p class="mce-root"/>
<p><span class="koboSpan" id="kobo.33.1">Similarly, it is possible to determine the probability with which the observations are distributed around the average value, in proportion to the value of the variance; in other words, we can determine the following:</span></p>
<ul>
<li class="mce-root"><span><span class="koboSpan" id="kobo.34.1">68% of observations fall within the range between</span></span> <em><span class="koboSpan" id="kobo.35.1">µ - σ</span></em> <span><span class="koboSpan" id="kobo.36.1">and</span></span> <em><span class="koboSpan" id="kobo.37.1">µ + σ</span></em></li>
<li class="mce-root"><span class="koboSpan" id="kobo.38.1">95% of observations fall within the range between </span><em><span class="koboSpan" id="kobo.39.1">µ - 2σ</span></em> <span><span class="koboSpan" id="kobo.40.1">and</span></span> <em><span class="koboSpan" id="kobo.41.1">µ + 2σ</span></em></li>
<li class="mce-root"><span class="koboSpan" id="kobo.42.1">99.7% of observations fall within the range between </span><em><span class="koboSpan" id="kobo.43.1">µ - 3σ</span></em> <span><span class="koboSpan" id="kobo.44.1">and</span></span> <em><span class="koboSpan" id="kobo.45.1">µ + 3σ</span></em></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Anomaly detection using the Gaussian distribution</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">The Gaussian distribution can be used to identify the outliers. </span><span class="koboSpan" id="kobo.2.2">Also, in this case, the anomaly element consists of the significant difference assumed by the outliers with respect to the rest of the data.</span></p>
<p><span class="koboSpan" id="kobo.3.1">Obviously, the more the majority of the data is firmly concentrated around the mean value, </span><em><span class="koboSpan" id="kobo.4.1">µ</span></em><span class="koboSpan" id="kobo.5.1">, with a low variance, </span><em><span class="koboSpan" id="kobo.6.1">σ</span></em><span class="koboSpan" id="kobo.7.1">, the more </span><span><span class="koboSpan" id="kobo.8.1">significant </span></span><span class="koboSpan" id="kobo.9.1">the anomalous value assumed by the outlier is.</span></p>
<p><span class="koboSpan" id="kobo.10.1">To use the Gaussian distribution in anomaly detection, we will have to perform the following steps:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.11.1">Assume that the features of the training set are normally distributed (this can also be verified intuitively from the visual analysis of plotted data)</span></li>
<li><span class="koboSpan" id="kobo.12.1">Estimate the </span><em><span class="koboSpan" id="kobo.13.1">µ</span></em><span class="koboSpan" id="kobo.14.1"> and </span><em><span class="koboSpan" id="kobo.15.1">σ</span></em><span class="koboSpan" id="kobo.16.1"> values, representative of the distribution</span></li>
<li><span class="koboSpan" id="kobo.17.1">Choose an adequate threshold, representative of the probability that the observations are anomalous</span></li>
<li><span class="koboSpan" id="kobo.18.1">Assess the reliability of the algorithm</span></li>
</ol>
<p><span class="koboSpan" id="kobo.19.1">In the following example, we will show an implementation of Gaussian anomaly detection.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Gaussian anomaly detection example</span></h1>
                </header>
            
            <article>
                
<p><span><span class="koboSpan" id="kobo.2.1">First of all, let's import the necessary Python libraries, and then load the data from a </span><kbd><span class="koboSpan" id="kobo.3.1">.csv</span></kbd><span class="koboSpan" id="kobo.4.1"> file that represents the latency and network throughput values of each data stream we detected:</span></span></p>
<pre><span class="koboSpan" id="kobo.5.1">import numpy as np</span><br/><span class="koboSpan" id="kobo.6.1">import pandas as pd</span><br/><span class="koboSpan" id="kobo.7.1">import matplotlib.pyplot as plt</span><br/><span class="koboSpan" id="kobo.8.1">%matplotlib inline</span><br/><br/><span class="koboSpan" id="kobo.9.1">dataset = pd.read_csv('../datasets/network-logs.csv')</span></pre>
<p><span><span class="koboSpan" id="kobo.10.1">Once the data is loaded into memory, we verify whether the distribution of the samples might resemble a Gaussian distribution, displaying the corresponding values in the form of a histogram:</span></span></p>
<pre><span class="koboSpan" id="kobo.11.1">hist_dist = dataset[['LATENCY', 'THROUGHPUT']].hist(grid=False, figsize=(10,4))</span></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="CDPAlignLeft CDPAlign"><span class="koboSpan" id="kobo.12.1">The preceding code generates the following output:</span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.13.1"><img src="assets/2f7eb18f-881b-4aa1-bf9b-feff330cf362.png" style="width:38.00em;height:16.67em;"/></span></p>
<p><span><span class="koboSpan" id="kobo.14.1">At this point, we perform the data plotting on a scatter diagram, visually identifying the possible outliers:</span></span></p>
<pre><span class="koboSpan" id="kobo.15.1">data = dataset[['LATENCY', 'THROUGHPUT']].values</span><br/><br/><span class="koboSpan" id="kobo.16.1">plt.scatter(data[:, 0], data[:, 1], alpha=0.6)</span><br/><span class="koboSpan" id="kobo.17.1">plt.xlabel('LATENCY')</span><br/><span class="koboSpan" id="kobo.18.1">plt.ylabel('THROUGHPUT')</span><br/><span class="koboSpan" id="kobo.19.1">plt.title('DATA FLOW')</span><br/><span class="koboSpan" id="kobo.20.1">plt.show()</span></pre>
<p class="CDPAlignLeft CDPAlign"><span class="koboSpan" id="kobo.21.1">The preceding code generates the following output:</span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.22.1"><img src="assets/ef93f94d-3568-4861-863e-e9203e14e9d7.png" style="width:34.75em;height:24.42em;"/></span></p>
<p><span class="koboSpan" id="kobo.23.1">As can </span><span><span class="koboSpan" id="kobo.24.1">also </span></span><span class="koboSpan" id="kobo.25.1">be seen visually, most of the observations are concentrated around the average values, except for some cases. </span><span class="koboSpan" id="kobo.25.2">We therefore want to verify whether the anomalous cases are real, and then we proceed to estimate the representative values, </span><em><span class="koboSpan" id="kobo.26.1">µ</span></em><span class="koboSpan" id="kobo.27.1"> and </span><em><span class="koboSpan" id="kobo.28.1">σ</span></em><span class="koboSpan" id="kobo.29.1">, of the underlying Gaussian distribution:</span></p>
<pre><span class="koboSpan" id="kobo.30.1">"""</span><br/><span class="koboSpan" id="kobo.31.1">Anomaly Detection Module</span><br/><span class="koboSpan" id="kobo.32.1">Thanks to Oleksii Trekhleb:</span><br/><span class="koboSpan" id="kobo.33.1">https://github.com/trekhleb/homemade-machine-learning/blob/master/homemade/anomaly_detection/gaussian_anomaly_detection.py</span><br/><span class="koboSpan" id="kobo.34.1">"""</span><br/><span class="koboSpan" id="kobo.35.1">from gaussian_anomaly_detection import GaussianAnomalyDetection</span><br/><br/><span class="koboSpan" id="kobo.36.1">gaussian_anomaly_detection = GaussianAnomalyDetection(data)</span><br/><br/><span class="koboSpan" id="kobo.37.1">print('mu param estimation: ')</span><br/><span class="koboSpan" id="kobo.38.1">print(gaussian_anomaly_detection.mu_param)</span><br/><br/><span class="koboSpan" id="kobo.39.1">print('\n')</span><br/><br/><span class="koboSpan" id="kobo.40.1">print('sigma squared estimation: ')</span><br/><span class="koboSpan" id="kobo.41.1">print(gaussian_anomaly_detection.sigma_squared)</span><br/><br/><span class="koboSpan" id="kobo.42.1">mu param estimation:  </span><br/><span class="koboSpan" id="kobo.43.1">[14.42070163 15.39209133]</span><br/><br/><span class="koboSpan" id="kobo.44.1">sigma squared estimation: </span><br/><span class="koboSpan" id="kobo.45.1">[2.09674794 1.37224807]</span></pre>
<p><span><span class="koboSpan" id="kobo.46.1">We then proceed to estimate the probabilities and threshold value, which we can then compare to identify the anomalous data:</span></span></p>
<pre><span class="koboSpan" id="kobo.47.1">targets = dataset['ANOMALY'].values.reshape((data.shape[0], 1))</span><br/><span class="koboSpan" id="kobo.48.1">probs = gaussian_anomaly_detection.multivariate_gaussian(data)</span><br/><br/><span class="koboSpan" id="kobo.49.1">(threshold, F1, precision_, recall_, f1_) =</span><br/><span class="koboSpan" id="kobo.50.1">gaussian_anomaly_detection.select_threshold(targets, probs)</span><br/><br/><span class="koboSpan" id="kobo.51.1">print('\n')</span><br/><br/><span class="koboSpan" id="kobo.52.1">print('threshold estimation: ')</span><br/><span class="koboSpan" id="kobo.53.1">print(threshold)</span><br/><br/><span class="koboSpan" id="kobo.54.1">threshold estimation: </span><br/><span class="koboSpan" id="kobo.55.1">0.00027176836728971885</span></pre>
<p><span class="koboSpan" id="kobo.56.1">At this point, we are able to identify the outliers by comparing the individual probabilities of the samples with the </span><span><span class="koboSpan" id="kobo.57.1">previously estimated </span></span><span class="koboSpan" id="kobo.58.1">optimal threshold value, visualizing their presence in a scatter diagram:</span></p>
<pre><span class="koboSpan" id="kobo.59.1">outliers = np.where(probs &lt; threshold)[0]</span><br/><span class="koboSpan" id="kobo.60.1">plt.scatter(data[:, 0], data[:, 1], alpha=0.6, label='Dataset')</span><br/><span class="koboSpan" id="kobo.61.1">plt.xlabel('LATENCY')</span><br/><span class="koboSpan" id="kobo.62.1">plt.ylabel('THROUGHPUT')</span><br/><span class="koboSpan" id="kobo.63.1">plt.title('DATA FLOW')</span><br/><br/><span class="koboSpan" id="kobo.64.1">plt.scatter(data[outliers, 0], data[outliers, 1], alpha=0.6, c='red', label='Outliers')</span><br/><br/><span class="koboSpan" id="kobo.65.1">plt.legend()</span><br/><span class="koboSpan" id="kobo.66.1">plt.plot()</span></pre>
<p class="CDPAlignLeft CDPAlign"><span class="koboSpan" id="kobo.67.1">The preceding code generates the following output:</span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.68.1"><img src="assets/4635736b-5bd7-4c39-9ed5-a24a49643e7f.png" style="width:25.08em;height:18.08em;"/></span></p>
<p><span class="koboSpan" id="kobo.69.1">The time has come to make some assessments on the estimates made by the algorithm. </span><span class="koboSpan" id="kobo.69.2">But first, we will have to introduce some concepts related to the identification of false alarms in anomaly detection.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">False alarm management in anomaly detection</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">We have previously seen how anomaly detection gives rise to rather consistent estimation errors. </span><span class="koboSpan" id="kobo.2.2">In particular, in the case of IDS based on signatures, the risk of error is represented by the high number of false negatives, that is, attacks that are not detected.</span></p>
<p><span class="koboSpan" id="kobo.3.1">It is the same type of risk that we incur when using antivirus software. </span><span class="koboSpan" id="kobo.3.2">When a correspondence with the suspicious signature is not found, the IDS does not detect any anomalies.</span></p>
<p><span class="koboSpan" id="kobo.4.1">On the other hand, in the case of anomaly-driven IDS, which is programmed to detect anomalies automatically, we face the risk of having a high number of false positives; that is, anomalies that are detected despite not being harmful.</span></p>
<p><span class="koboSpan" id="kobo.5.1">To adequately manage these false alarms, we need to introduce some metrics that will help us to estimate these errors.</span></p>
<p><span><span class="koboSpan" id="kobo.6.1">The first one is </span><kbd><span class="koboSpan" id="kobo.7.1">True Positive Rate</span></kbd><span class="koboSpan" id="kobo.8.1"> (also known as </span><kbd><span class="koboSpan" id="kobo.9.1">Sensitivity</span></kbd><span class="koboSpan" id="kobo.10.1"> or the recall rate):</span></span></p>
<pre><span class="koboSpan" id="kobo.11.1">Sensitivity or True Positive Rate (TPR) = True Positive / (True Positive + False Negative);</span></pre>
<p><span class="koboSpan" id="kobo.12.1">Then, we have </span><kbd><span class="koboSpan" id="kobo.13.1">False Positive Rate</span></kbd><span class="koboSpan" id="kobo.14.1">:</span></p>
<pre><span class="koboSpan" id="kobo.15.1">False Positive Rate (FPR) = False Positive / (False Positive + True Negative);</span><br/><br/><span class="koboSpan" id="kobo.16.1">Precision = True Positive / (True Positive + False Positive);</span></pre>
<p><span><span class="koboSpan" id="kobo.17.1">On the basis of these metrics, it is possible to estimate the </span><kbd><span class="koboSpan" id="kobo.18.1">F1</span></kbd><span class="koboSpan" id="kobo.19.1"> value, which represents the harmonic average between </span><kbd><span class="koboSpan" id="kobo.20.1">Precision</span></kbd><span class="koboSpan" id="kobo.21.1"> and </span><kbd><span class="koboSpan" id="kobo.22.1">Sensitivity</span></kbd><span class="koboSpan" id="kobo.23.1">:</span></span></p>
<pre><span class="koboSpan" id="kobo.24.1">F1 = 2 * Precision * Sensitivity / (Precision + Sensitivity);</span></pre>
<p><kbd><span class="koboSpan" id="kobo.25.1">F1</span></kbd><span class="koboSpan" id="kobo.26.1"> can be used to evaluate the results obtained from Gaussian anomaly detection. </span><span class="koboSpan" id="kobo.26.2">The best estimates are obtained with </span><kbd><span class="koboSpan" id="kobo.27.1">F1</span></kbd><span class="koboSpan" id="kobo.28.1"> values close to </span><kbd><span class="koboSpan" id="kobo.29.1">1</span></kbd><span class="koboSpan" id="kobo.30.1">, while the worst estimates correspond to </span><kbd><span class="koboSpan" id="kobo.31.1">F1</span></kbd><span class="koboSpan" id="kobo.32.1"> values that are close to </span><kbd><span class="koboSpan" id="kobo.33.1">0</span></kbd><span class="koboSpan" id="kobo.34.1">.</span></p>
<p><span class="koboSpan" id="kobo.35.1">In our example of Gaussian anomaly detection, the value of </span><kbd><span class="koboSpan" id="kobo.36.1">F1</span></kbd><span class="koboSpan" id="kobo.37.1"> is as follows:</span></p>
<pre><span class="koboSpan" id="kobo.38.1">print('F1 score: ')</span><br/><span class="koboSpan" id="kobo.39.1">print(F1)</span><br/><br/><span class="koboSpan" id="kobo.40.1">F1 score: </span><br/><span class="koboSpan" id="kobo.41.1">0.6666666666666666</span></pre>
<p><span class="koboSpan" id="kobo.42.1">This </span><kbd><span class="koboSpan" id="kobo.43.1">F1</span></kbd> <span><span class="koboSpan" id="kobo.44.1">value </span></span><span class="koboSpan" id="kobo.45.1">is rather close to </span><kbd><span class="koboSpan" id="kobo.46.1">1</span></kbd><span class="koboSpan" id="kobo.47.1">, which does not surprise us, since in choosing the best threshold, our Gaussian anomaly detection model selects the value that corresponds to the highest </span><kbd><span class="koboSpan" id="kobo.48.1">F1</span></kbd><span class="koboSpan" id="kobo.49.1"> score.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Receiver operating characteristic analysis</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">Often, between false positives and false negatives, there is a trade-off. </span><span class="koboSpan" id="kobo.2.2">Reducing the number of false negatives or the number of attacks not detected leads to an increase in false positive attacks being detected. </span><span class="koboSpan" id="kobo.2.3">To show the existence of this trade-off, a particular curve, known as the </span><strong><span class="koboSpan" id="kobo.3.1">receiver operating characteristic</span></strong><span class="koboSpan" id="kobo.4.1"> (</span><strong><span class="koboSpan" id="kobo.5.1">ROC</span></strong><span class="koboSpan" id="kobo.6.1">) curve, is used. </span><span class="koboSpan" id="kobo.6.2">In our example, the ROC curve is calculated by using </span><kbd><span class="koboSpan" id="kobo.7.1">roc_curve()</span></kbd><span class="koboSpan" id="kobo.8.1"> of </span><kbd><span><span class="koboSpan" id="kobo.9.1">sc</span></span><span><span class="koboSpan" id="kobo.10.1">ikit-learn</span></span></kbd><span class="koboSpan" id="kobo.11.1">, to which the target values and the corresponding probabilities are passed as parameters:</span></p>
<pre><span class="koboSpan" id="kobo.12.1">from sklearn.metrics import roc_curve</span><br/><br/><span class="koboSpan" id="kobo.13.1">FPR, TPR, OPC = roc_curve(targets, probs)</span></pre>
<p class="mceNonEditable"><span><span class="koboSpan" id="kobo.14.1">It is possible to note the</span></span><span class="koboSpan" id="kobo.15.1"> link </span><span><span class="koboSpan" id="kobo.16.1">between</span></span> <strong><span class="koboSpan" id="kobo.17.1">True Positive Rate</span></strong> <span><span class="koboSpan" id="kobo.18.1">(</span></span><kbd><span class="koboSpan" id="kobo.19.1">TPR</span></kbd> <span><span class="koboSpan" id="kobo.20.1">or sensitivity),</span></span> <strong><span class="koboSpan" id="kobo.21.1">False Positive Rate</span></strong> <span><span class="koboSpan" id="kobo.22.1">(</span></span><kbd><span class="koboSpan" id="kobo.23.1">FPR</span></kbd><span><span class="koboSpan" id="kobo.24.1">), and the ROC curve (the</span></span> <kbd><span class="koboSpan" id="kobo.25.1">OPC</span></kbd> <span><span class="koboSpan" id="kobo.26.1">value instead represents a</span></span><span class="koboSpan" id="kobo.27.1"> control </span><span><span class="koboSpan" id="kobo.28.1">coefficient, known as the </span></span><strong><span class="koboSpan" id="kobo.29.1">Operating Characteristic</span></strong><span><span class="koboSpan" id="kobo.30.1">, such as the</span></span><span class="koboSpan" id="kobo.31.1"> total </span><span><span class="koboSpan" id="kobo.32.1">number of connections).</span></span></p>
<p><span class="koboSpan" id="kobo.33.1">We can therefore represent sensitivity by plotting the </span><kbd><span class="koboSpan" id="kobo.34.1">TPR</span></kbd><span class="koboSpan" id="kobo.35.1"> value with respect to the value of the </span><kbd><span class="koboSpan" id="kobo.36.1">OPC</span></kbd><span class="koboSpan" id="kobo.37.1"> control coefficient:</span></p>
<pre><span class="koboSpan" id="kobo.38.1"># Plotting Sensitivity</span><br/><br/><span class="koboSpan" id="kobo.39.1">plt.plot(OPC,TPR)</span></pre>
<p class="CDPAlignLeft CDPAlign"><span class="koboSpan" id="kobo.40.1">The preceding code generates the following output: </span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.41.1"><img src="assets/05f306df-6364-47da-88b2-7db76d048996.png"/></span></p>
<p><span class="koboSpan" id="kobo.42.1">We can also see how sensitivity (</span><kbd><span class="koboSpan" id="kobo.43.1">TPR</span></kbd><span class="koboSpan" id="kobo.44.1">) decreases as the value of </span><kbd><span class="koboSpan" id="kobo.45.1">OPC</span></kbd><span class="koboSpan" id="kobo.46.1"> increases.</span></p>
<p><span class="koboSpan" id="kobo.47.1">In the same way, we can draw the ROC curve by comparing the sensitivity (</span><kbd><span class="koboSpan" id="kobo.48.1">TPR</span></kbd><span class="koboSpan" id="kobo.49.1">) with the </span><kbd><span class="koboSpan" id="kobo.50.1">FPR</span></kbd><span class="koboSpan" id="kobo.51.1"> value:</span></p>
<pre><span class="koboSpan" id="kobo.52.1"># Plotting ROC curve</span><br/><br/><span class="koboSpan" id="kobo.53.1">plt.plot(FPR,TPR)</span></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p class="CDPAlignLeft CDPAlign"><span><span class="koboSpan" id="kobo.54.1">The preceding code generates the following output:</span></span></p>
<p class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.55.1"><img src="assets/d14a609c-a646-46ad-9b5a-fd4768b067d7.png" style="width:26.08em;height:17.50em;"/></span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Summary</span></h1>
                </header>
            
            <article>
                
<p><span class="koboSpan" id="kobo.2.1">In an increasingly interconnected world, and with the progressive spread of the IoT, it becomes essential to effectively analyze network traffic in search of anomalies that can represent reliable indications of possible compromises (such as the presence of botnets).</span></p>
<p><span class="koboSpan" id="kobo.3.1">On the other hand, the exclusive use of automated systems in performing network anomaly detection tasks exposes us to the risk of having to manage an increasing number of misleading signals (false positives).</span></p>
<p><span class="koboSpan" id="kobo.4.1">It is, therefore, more appropriate to integrate the automated anomaly detection activities with analysis carried out by human operators, exploiting AI algorithms as filters, in order to only select the anomalies that are really worthy of in-depth attention from the analysts.</span></p>
<p><span class="koboSpan" id="kobo.5.1">In the next chapter we will deal with AI solutions for securing user authentication.</span></p>


            </article>

            
        </section>
    </body></html>